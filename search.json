[{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"overview-of-tcgsa","dir":"Articles","previous_headings":"","what":"Overview of TcGSA","title":"User guide to the `TcGSA` R package","text":"TcGSA (Time-course Gene Set Analysis Hejblum et al., 2015) R package tests gene expression dynamics significance gene sets. gene set group genes, known priori share common biological function co-expressed. TcGSA relies linear mixed model take account potential heterogeneity expression within gene set. details, check published article PLOS Computational Biology.","code":""},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"getting-started-using-tcgsa","dir":"Articles","previous_headings":"","what":"Getting started using TcGSA","title":"User guide to the `TcGSA` R package","text":"3 inputs required run TcGSA: gene set object gene expression matrix design data matrix","code":""},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"gene-set-object","dir":"Articles","previous_headings":"Getting started using TcGSA","what":"Gene set object","title":"User guide to the `TcGSA` R package","text":"gene set group genes either sharing biological function . enables detect different gene expression seems powerful gene--gene analysis. Several definitions groups made, particular focus following: Chaussabel’s modules (Chaussabel et al., 2008) Gene Ontology database (Ashburner et al., 2000) Kyoto Encyclopedia Genes Genomes database (Kanehisa et Goto, 2000) gene set object gmt format containing: name gene set description gene set, biological function list probes representing genes inside gene set One can either use already existing gmt objects, build .","code":""},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"download-gmts-from-hejblum-et-al--2015","dir":"Articles","previous_headings":"Getting started using TcGSA > Gene set object","what":"Download gmts from Hejblum et al., 2015","title":"User guide to the `TcGSA` R package","text":"import gmts used Hejblum et al., 2015, one can download supplementary file running following command: contains 3 gene sets detailed (GO, subset mutually exclusive gene sets biological functions related immune system). Disclaimer: careful version gene set databases probably outdated now. make sure latest version database, can (re-)build gmt object following method .","code":"temp <- tempfile() utils::download.file(\"http://doi.org/10.1371/journal.pcbi.1004310.s007\", destfile = temp, mode = \"wb\") load(unz(temp, \"ReproducibleRFiles/GMTs_PLOScb.RData\", open = \"r\")) unlink(temp) rm(temp)"},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"self-built-gmt","dir":"Articles","previous_headings":"Getting started using TcGSA > Gene set object","what":"Self-built gmt","title":"User guide to the `TcGSA` R package","text":"self-build gmt object, prepare .gmt file. file format tab delimited file can created helpful website Broad Institute. file, one row represents one gene set : Column 1: name gene set Column 2: description gene set Remaining columns: list genes included gene set (represented probes) Next, import .gmt file R, need run GSA.read.gmt() function GSA package. details GSA help package.","code":""},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"gene-expression-matrix","dir":"Articles","previous_headings":"Getting started using TcGSA","what":"Gene expression matrix","title":"User guide to the `TcGSA` R package","text":"matrix contains gene expression (cells) gene (rows) sample (columns) gathered microarray measurements. gene expression already normalized using TcGSA. rownames, name probe/gene must match name probes/genes gmt object.","code":""},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"design-data-matrix","dir":"Articles","previous_headings":"Getting started using TcGSA","what":"Design data matrix","title":"User guide to the `TcGSA` R package","text":"design data matrix contains sample (row), several variables (column). variables required matrix : Sample names Patient identifiers Time measurements case multiple treatments, name treatment Name samples unique match samples gene expression matrix order.","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"data-preparation","dir":"Articles","previous_headings":"How to use TcGSA for one treatment group ?","what":"Data preparation","title":"User guide to the `TcGSA` R package","text":"example comes Hejblum et al., 2015 DALIA-1 HIV therapeutic vaccine trial. aim study evaluate immune response HIV vaccine. conduct study, 19 patients contaminated HIV followed 48 weeks split 2 phases 24 : 1st phase week 0 week 24 (treatment interruption): patients anti-retroviral treatment received trial vaccine week 0, 4, 8 12. 2nd phase week 24 week 48 (treatment interruption): follow-patients, none trial vaccine injected anti-retroviral treatments interrupted (except health problems). Blood samples collected different measurement time points, subject, study dynamic gene expression time. details, check article Hejblum et al. . data publicly available GEO website GEO access number ‘GSE46734’. using GEOquery package get data files GEO website (see appendix details GEOquery)","code":""},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"import-of-data-files","dir":"Articles","previous_headings":"How to use TcGSA for one treatment group ? > Data preparation","what":"Import of data files","title":"User guide to the `TcGSA` R package","text":"example, need import supplementary files available GEOwith getGEOSuppFiles function (need three following files, hence regular expression filter: gene expression pre-ATI, gene expression post-ATI, experimental design):","code":"GEOquery::getGEOSuppFiles('GSE46734', filter_regex=\"(*NonParamCombat*)|(*DESIGN*)\")"},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"design-data-matrix-1","dir":"Articles","previous_headings":"How to use TcGSA for one treatment group ? > Data preparation","what":"Design data matrix","title":"User guide to the `TcGSA` R package","text":"design data matrix (called design_preATI) extracted one GEO supplementary files. contains needed experimental variables, plus additional information regarding study. data processing performed made according source paper. data frame contains 90 samples 6 experimental variables : Sample_name name samples Patient_ID identification patients TimePoint time measurements Chip_ID HYB_Chamber HYB_Day variables required TcGSA commands","code":"design <- read.delim(gzfile(\"GSE46734/GSE46734_DALIA1longitudinalTranscriptome_DESIGN_anonym.txt.gz\")) design_preATI <- design[-which(design$TimePoint<0 | design$TimePoint==16 | design$TimePoint>22), ] head(design_preATI,5) #>     Sample_name Chip_ID HYB_Chamber HYB_Day Patient_ID TimePoint #> 1 X6116733008_L      C4         CH1      D1       P001         4 #> 3 X6116733022_E     C13         CH4      D1       P001        22 #> 5 X6116733029_A     C18         CH1      D2       P001         8 #> 6 X6116733068_L     C25         CH3      D2       P001        12 #> 8 X6116733073_K     C29         CH4      D2       P001         0"},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"gene-expression-matrix-1","dir":"Articles","previous_headings":"How to use TcGSA for one treatment group ? > Data preparation","what":"Gene expression matrix","title":"User guide to the `TcGSA` R package","text":"gene expression matrix (called expr_preATI) extracted one GEO supplementary files (namely “GSE46734_DALIA1longitudinalTranscriptome_PALO01_PreATI_NEQC_NonParamCombat.txt.gz” file). NB: data already normalized. : row ILMN_xxxxxxx probe identifier column Xxxxxxxxxxx_X name sample cell contains normalized gene expression entire matrix contains \\(32,978\\) genes \\(90\\) samples (number samples design data matrix)","code":"expr_preATI <- read.delim(gzfile(\"GSE46734/GSE46734_DALIA1longitudinalTranscriptome_PALO01_PreATI_NEQC_NonParamCombat.txt.gz\")) rownames(expr_preATI) <- expr_preATI$PROBE_ID expr_preATI <- expr_preATI[,as.character(design_preATI$Sample_name)]  expr_preATI[1:4,1:4] #>              X6116733008_L X6116733022_E X6116733029_A X6116733068_L #> ILMN_1762337      4.967101      4.398911      4.384093      4.927489 #> ILMN_2055271      5.215882      4.744463      5.038972      5.209726 #> ILMN_2383229      4.565933      4.578123      4.696965      4.306206 #> ILMN_1806310      4.402265      4.473504      4.598726      4.589389 identical(ncol(expr_preATI), nrow(design_preATI)) #> [1] TRUE"},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"likelihood-ratios-test","dir":"Articles","previous_headings":"How to use TcGSA for one treatment group ?","what":"Likelihood ratios test","title":"User guide to the `TcGSA` R package","text":"function provides result likelihood ratio test using linear mixed model gene set. example, use gene sets data Chaussabel’s modules (Chaussabel et al., 2008). TcGSA.LR function requires: expr: name gene expression matrix gmt: name gmt gene set object design: name design data matrix subject_name: name identification patients design data matrix time_name: name time measurements design data matrix Now tcgsa_result tcgsa object containing, addition likelihood ratio test results: form tested time trends (default option linear) number treatment groups number gene sets tested (depending gene set base defined) information get number significant gene sets, one can use summary function tcgsa object: get details significant gene sets, use signifLRT.TcGSA() function. returns information significant gene sets among gene sets tested, along p-values adjustment multiple testing (default option Benjamini-Yekutieli correction Benjamini et Yekutieli, 2001 5% threshold). example five significant gene sets: can also use multtest.TcGSA function provide likelihood ratios, raw adjusted p-values whole gene sets 5% threshold. example displaying five results: CVG_H0 CVG_H1 convergence model null alternative hypotheses. 0 indicates good convergence model (based lme4 output).","code":"tcgsa_result <- TcGSA::TcGSA.LR(expr = expr_preATI,                                  gmt = gmt_modulesV2,                                  design = design_preATI,                                  subject_name = \"Patient_ID\",                                  time_name = \"TimePoint\") #>      A TcGSA object #> Form of the time trend: #>  linear #> Number of treatment groups: #>  1 #> Number of gene sets tested for significant time trend: #>  260 summary(tcgsa_result) #>      A TcGSA object #> Form of the time trend: #>  linear #> Number of treatment groups: #>  1 #> Number of gene sets tested for significant time trend: #>  260 #>  #> Number of significant gene sets at a 5% threshold (BY procedure): #>  17 out of 260 gene sets head(TcGSA::signifLRT.TcGSA(tcgsa_result)$mixedLRTadjRes) #>   GeneSet      AdjPval         desc #> 1    M1.1 8.296095e-09    Platelets #> 2    M3.2 4.096412e-08 Inflammation #> 3    M3.5 3.952334e-02   Cell Cycle #> 6    M4.6 1.337921e-06 Inflammation #> 7    M4.9 3.820230e-04 Undetermined #> 4   M4.11 7.411800e-07 Plasma Cells head(TcGSA::multtest.TcGSA(tcgsa_result)) #>           LR CVG_H0 CVG_H1     raw_pval     adj_pval #> 1 48.5951385      0      0 1.559071e-11 8.296095e-09 #> 2  0.4574752      0      0 6.471718e-01 1.000000e+00 #> 3  3.1626395      0      0 1.405224e-01 1.000000e+00 #> 4  1.6726757      0      0 3.145975e-01 1.000000e+00 #> 5  0.1412185      0      0 8.194493e-01 1.000000e+00 #> 6  0.1036336      0      0 8.485074e-01 1.000000e+00"},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"graphical-outputs","dir":"Articles","previous_headings":"How to use TcGSA for one treatment group ?","what":"Graphical outputs","title":"User guide to the `TcGSA` R package","text":"plot1GS() plots different representations gene expression specific gene set interest (specified geneset.name argument). function requires following: expr: either name gene expression matrix estimations linear mixed model (example, used raw data gene expression matrix) gmt: name gmt gene set object Subject_ID: name identification patients design data matrix TimePoint: name time measurements design data matrix geneset.name: name gene set (significant ones can found signifLRT.TcGSA(tcgsa_result)$mixedLRTadjRes) time_unit: string displayed values TimePoint x-axis (‘D’ ‘days’ instance - optional)  Dotted line shows median gene expression across subjects, gene set time.","code":"TcGSA::plot1GS(expr = expr_preATI,                 #plot1GS(expr = tcgsa_result$Estimations,                gmt = gmt_modulesV2,                 Subject_ID = design_preATI$Patient_ID,                 TimePoint = design_preATI$TimePoint,                clustering = FALSE,                 time_unit = \"W\",                 geneset.name = \"M3.2\",                 title=\"\",                margins=0.4,                lab.cex=0.37,                axis.cex=0.37,                line.size=0.45,                gg.add=list(ggplot2::theme(legend.position=\"none\"),                         ggplot2::ylim(-1.26,1.26)                ))"},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"how-to-use-tcgsa-for-several-treatment-group","dir":"Articles","previous_headings":"","what":"How to use TcGSA for several treatment group ?","title":"User guide to the `TcGSA` R package","text":"going take another example, Obermoser et al. 2013, study responses influenza pneumococcal vaccines healthy individuals using longitudinal gene expression. subjects split three groups 6 individuals, receiving either 2009-2010 seasonal influenza vaccine (Fluzone), 23-valent pneumococcal vaccine (Pneumovax23), placebo (saline solution). Blood samples acquired day -7, 0, 1, 3, 7, 10, 14, 21 28 study gene expression time. details, check article Obermoser et al. . data available GEO website GEO access number ‘GSE30101’, accessing GEOquery package (see appendix details GEOquery)","code":""},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"data-preparation-1","dir":"Articles","previous_headings":"How to use TcGSA for several treatment group ?","what":"Data preparation","title":"User guide to the `TcGSA` R package","text":", download data files import getGEO() function: Additional processing needed shape dataset gene expression matrix: experimental design data matrix can extracted following commands:","code":"utils::download.file(\"ftp://ftp.ncbi.nlm.nih.gov/geo/series/GSE30nnn/GSE30101/soft/GSE30101_family.soft.gz\", destfile = \"GSE30101_family.soft.gz\", mode = \"wb\", cacheOK = FALSE) gse.soft <- GEOquery::getGEO(filename=\"GSE30101_family.soft.gz\") probesIDs <- GEOquery::Table(GEOquery::GSMList(gse.soft)[[1]])$ID data.matrix <- do.call('cbind', lapply(GEOquery::GSMList(gse.soft),                                        function(x) {                                         tab <- GEOquery::Table(x)                                         mymatch <- match(probesIDs,tab$ID_REF)                                         return(tab$VALUE[mymatch])                                        })) rownames(data.matrix) <- probesIDs expr.All.ChaussVac <- apply(X = data.matrix, MARGIN = 2, FUN = as.numeric) rownames(expr.All.ChaussVac) <- probesIDs design_list <- lapply(GEOquery::GSMList(gse.soft),                        function(x){GEOquery::Meta(x)$characteristics_ch1}) design <- data.frame(row.names = names(design_list)) design$sample_ID <- names(design_list) s_id <- unlist(lapply(design_list, function(x){gsub(\"subject id: \", \"\", x[grep(\"subject id: \", x)])})) design$Subject_ID <- as.character(paste(\"P\", s_id[design$sample_ID], sep=\"\"))  time <- unlist(lapply(design_list, function(x){gsub(\"day: \", \"\", x[grep(\"day: \", x)])})) time[which(time %in% c(\"-7\", \"0.5\", \"1\", \"7\", \"10\", \"14\",  \"21\", \"28\"))] <-     paste(\"D\", time[which(time %in% c(\"-7\", \"0.5\", \"1\", \"7\", \"10\", \"14\", \"21\", \"28\"))], sep=\"\") time[which(time %in% c(\"-168\", \"1.5\", \"6\", \"9\", \"12\", \"15\", \"24\", \"36\", \"48\"))] <-     paste(\"H\", time[which(time %in% c(\"-168\", \"1.5\", \"6\", \"9\", \"12\", \"15\", \"24\", \"36\", \"48\"))], sep=\"\") design$Time <- as.character(time[design$sample_ID])  vac <- unlist(lapply(design_list, function(x){     gsub(\"vaccine: \", \"\", x[grep(\"vaccine: \", x)]) })) vac <- as.factor(vac) levels(vac) <- c(\"influenza\", \"influenza\", \"influenza\", \"influenza\", \"saline\",                   \"pneumo\", \"pneumo\", \"pneumo\", \"saline\", \"saline\") design$Vaccine <- as.character(vac[design$sample_ID])  sampSet <- unlist(lapply(design_list, function(x){     gsub(\"sample set: \", \"\", x[grep(\"sample set: \", x)]) })) design$sampSet <- as.character(sampSet[design$sample_ID])  design$Time[which(design$sampSet==\"Training_Set_Vein\" & design$Time %in% c(\"0\", \"3\"))] <-     paste(\"D\", design$Time[which(design$sampSet==\"Training_Set_Vein\" & design$Time %in% c(\"0\", \"3\"))], sep=\"\") design$Time[which(design$sampSet==\"Training_Set_Finger\" & design$Time %in% c(\"0\", \"3\"))] <-     paste(\"H\", design$Time[which(design$sampSet==\"Training_Set_Finger\" & design$Time %in% c(\"0\", \"3\"))], sep=\"\") design$Time[which(design$sampSet==\"Test_Set_Vein\" & design$Time %in% c(\"0\", \"3\"))] <-     paste(\"D\", design$Time[which(design$sampSet==\"Test_Set_Vein\" & design$Time %in% c(\"0\", \"3\"))], sep=\"\") design$Time[which(design$sampSet==\"Test_Set_Finger\" & design$Time %in% c(\"0\", \"3\"))] <-     paste(\"D\", design$Time[which(design$sampSet==\"Test_Set_Finger\" & design$Time %in% c(\"0\", \"3\"))], sep=\"\") design$Time[which(design$sampSet==\"Validation_Vein\" & design$Time %in% c(\"0\", \"3\"))] <-     paste(\"D\", design$Time[which(design$sampSet==\"Validation_Vein\" & design$Time %in% c(\"0\", \"3\"))], sep=\"\")  design$Day <- gsub(\"D\", \"\", design$Time) design$Day[grep(\"H\", design$Day)] <- as.numeric(gsub(\"H\", \"\", design$Day[grep(\"H\", design$Day)]))/24 design$Day <- as.numeric(design$Day)  design.All.ChaussVac <- design    # Avg Baseline ----- design.All.ChaussVac.trainSetVein <- design.All.ChaussVac[which(design.All.ChaussVac$sampSet==\"Training_Set_Vein\"),] samplesSaline2rmv <- design.All.ChaussVac.trainSetVein[162:214,\"sample_ID\"] design.All.ChaussVac.noDup <- design.All.ChaussVac.trainSetVein[-which(design.All.ChaussVac.trainSetVein$sample_ID%in%samplesSaline2rmv),]  design.All.ChaussVac.AvgBl <- design.All.ChaussVac.noDup[which(design.All.ChaussVac.noDup$Day!=0),] design.All.ChaussVac.AvgBl[which(design.All.ChaussVac.AvgBl$Day==-7),\"Day\"] <- 0 design.All.ChaussVac.AvgBl[which(design.All.ChaussVac.AvgBl$Time==\"D-7\"),\"Time\"] <- \"D0\"  expr.All.ChaussVac.AvgBl <- expr.All.ChaussVac[, design.All.ChaussVac.AvgBl$sample_ID] for(p in unique(design.All.ChaussVac.AvgBl$Subject_ID)){     if(length(which(design.All.ChaussVac.noDup$Subject_ID==p & (design.All.ChaussVac.noDup$Day==0 | design.All.ChaussVac.noDup$Day==-7)))>1){         expr.All.ChaussVac.AvgBl[, which(design.All.ChaussVac.AvgBl$Subject_ID==p & design.All.ChaussVac.AvgBl$Day==0)] <-             apply(X=cbind(expr.All.ChaussVac[, design.All.ChaussVac.noDup[which(design.All.ChaussVac.noDup$Subject_ID==p & design.All.ChaussVac.noDup$Day==0), \"sample_ID\"]],                           expr.All.ChaussVac[, design.All.ChaussVac.noDup[which(design.All.ChaussVac.noDup$Subject_ID==p & design.All.ChaussVac.noDup$Day==-7), \"sample_ID\"]]),                   MARGIN=1, FUN=mean, na.rm=TRUE)     } } rownames(expr.All.ChaussVac.AvgBl) <- probesIDs  if(!all.equal(as.character(design.All.ChaussVac.AvgBl$sample_ID), colnames(expr.All.ChaussVac.AvgBl))){stop(\"\\n\\n\\nWARNING: EXPRESSION FILE ORDER NOT MATCHING DESIGN FILE\\n\\n\\n\")} design.All.ChaussVac.AvgBl$Subject_ID <- as.factor(design.All.ChaussVac.AvgBl$Subject_ID)   design.PNEUMOvsSALINE.ChaussVac.AvgBl <- design.All.ChaussVac.AvgBl[which(design.All.ChaussVac.AvgBl$Vaccine!=\"influenza\"), ] design.PNEUMOvsSALINE.ChaussVac.AvgBl$Vaccine <- as.factor(as.character(design.PNEUMOvsSALINE.ChaussVac.AvgBl$Vaccine))  expr.PNEUMOvsSALINE.ChaussVac.AvgBl <- expr.All.ChaussVac.AvgBl[,design.PNEUMOvsSALINE.ChaussVac.AvgBl$sample_ID]"},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"likelihood-ratio-tests","dir":"Articles","previous_headings":"How to use TcGSA for several treatment group ?","what":"Likelihood ratio tests","title":"User guide to the `TcGSA` R package","text":"function provides result likelihood ratio test using linear mixed model gene set. example, use gene sets data Chaussabel’s modules (Chaussabel et al., 2008). TcGSA.LR function requires: expr: gene expression matrix gmt: gmt gene set object design: design data matrix subject_name: identification patients design data matrix time_name: time measurements design data matrix group_name: group treatment design data matrix","code":"tcgsa_result_MT <- TcGSA::TcGSA.LR(expr = expr.PNEUMOvsSALINE.ChaussVac.AvgBl,                                     gmt = gmt_modulesV2,                                    design = design.PNEUMOvsSALINE.ChaussVac.AvgBl,                                     subject_name = \"Subject_ID\",                                     time_name = \"Day\",                                     group_name = \"Vaccine\") summary(tcgsa_result_MT) #>      A TcGSA object #> Form of the time trend: #>  linear #> Number of treatment groups: #>  2 #> Number of gene sets tested for significant time trend: #>  260 #>  #> Number of significant gene sets at a 5% threshold (BY procedure): #>  36 out of 260 gene sets head(TcGSA::signifLRT.TcGSA(tcgsa_result_MT)$mixedLRTadjRes) #>   GeneSet      AdjPval         desc #> 1    M1.1 1.284340e-09    Platelets #> 2    M1.2 5.945222e-06   Interferon #> 3    M2.3 1.633082e-04 Erythrocytes #> 4    M3.1 1.284340e-09 Erythrocytes #> 5    M3.2 3.554220e-10 Inflammation #> 6    M3.4 2.474143e-07   Interferon"},{"path":[]},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"make-clusters-from-tcgsa-object","dir":"Articles","previous_headings":"How to use TcGSA for several treatment group ? > Graphical outputs for significant gene sets","what":"Make clusters from tcgsa object","title":"User guide to the `TcGSA` R package","text":"clustTrend builds clusters genes trends dynamics. clustTrend function requires: tcgs: TcGSA object expr: estimation gene expressions linear mixed model TcGSA object Subject_ID: name identification patients design data matrix TimePoint: name time measurements design data matrix baseline (optional): value TimePoint used reference group_of_interest: name treatment design data matrix clust shows number trends within significant gene sets.","code":"clust <- TcGSA::clustTrend(tcgs = tcgsa_result_MT,                             expr=tcgsa_result_MT$Estimations,                            Subject_ID=design.PNEUMOvsSALINE.ChaussVac.AvgBl$Patient_ID,                            TimePoint=design.PNEUMOvsSALINE.ChaussVac.AvgBl$Day,                            group.var = design.PNEUMOvsSALINE.ChaussVac.AvgBl$Vaccine,                            group_of_interest=\"pneumo\",                            ref=\"saline\") clust #>          A ClusteredTrends object #>  #> Distribution of the number of trends per gene sets: #>  1 trend:  36 #>  2 trends: 0 #>  3 trends: 0 #>  4 trends: 0 #>  Total number of trends: 36 (out of 36 significant gene sets) #>  #> Maximal number of clusters tested: 4  #>  #> Mean number of trends by significant gene set:    1"},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"heatmap-of-significant-gene-sets","dir":"Articles","previous_headings":"How to use TcGSA for several treatment group ? > Graphical outputs for significant gene sets","what":"Heatmap of significant gene sets","title":"User guide to the `TcGSA` R package","text":"plot draws different kinds graphics, focus heatmap graphics. function requires: x: tcgsa object expr: estimation gene expressions linear mixed model tcgsa object Subject_ID: name subject identifier variable design data matrix TimePoint: name time measurement variable design data matrix group_of_interest: name treatment factor variable design data matrix clust_trends: cluster object clusters genes trends dynamics  heatmap shows (blue color) (red color) expression significant gene sets pneumo arm (vaccine) compared saline arm (compared) clust object. Similar expression dynamics clustered hierarchical clustering showed dendrogram. Note: figure different one Hejblum et al. used linear time function (sake simplicity computational speed). reproduce heatmap original article, one must use time_func argument specify quadratic time function offset Day 1.","code":"plot(x=tcgsa_result_MT, expr=tcgsa_result_MT$Estimations,      Subject_ID=design.PNEUMOvsSALINE.ChaussVac.AvgBl$Patient_ID,      TimePoint=design.PNEUMOvsSALINE.ChaussVac.AvgBl$TimePoint,      group_of_interest=\"pneumo\",      clust_trends=clust,      legend.breaks=seq(from=-2,to=2, by=0.01), time_unit=\"D\",      subtitle=\"Pneumo vs Saline\", cex.label.row=0.5, cex.label.col=1, cex.main=0.7,      heatmap.width=0.2, dendrogram.size=0.3, margins=c(2,3),      heatKey.size=0.8)"},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"User guide to the `TcGSA` R package","text":"Ashburner M, Ball CA, Blake JA, Botstein D, Butler H, Cherry JM, et al., (2000) Gene Ontology: tool unification biology. Nat Genet 25(1):25-9. Benjamini Y, Yekutieli D, (2001) Control False Discovery Rate Multiple Testing Dependency. Ann Stat 29(4):1165-88. Chaussabel D, Quinn C, Shen J, Patel P, Glaser C, Baldwin N, et al., (2008) Modular Analysis Framework Blood Genomics Studies: Application Systemic Lupus Erythematosus. Immunity 29(1):150-64. Hejblum BP, Skinner J, Thiebaut R, (2015) Time-Course Gene Set Analysis Longitudinal Gene Expression Data. PLOS Comput Biol 11(6):e1004310. Kanehisa M, Goto S, (2000) KEGG: Kyoto Encyclopedia Genes Genomes. Nucleic Acids Res 28(1):27-30. Obermoser G, Presnell S, Domico K, Xu H, Wang Y, Anguiano E, et al., (2013) Systems Scale Interactive Exploration Reveals Quantitative Qualitative Differences Response Influenza Pneumococcal Vaccines. Immunity 38(4):831-44.","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/articles/TcGSA_userguide.html","id":"geoquery-package","dir":"Articles","previous_headings":"Appendix","what":"GEOquery package","title":"User guide to the `TcGSA` R package","text":"case data want analyze publicly available Gene Expression Omnibus (GEO), can access GEOquery package, can installed following commands: details can found Bioconductor Davis S, Meltzer P, (2007) GEOquery: bridge Gene Expression Omnibus (GEO) Bioconductor Bioinformatics 14:1846-1847.","code":"if (!requireNamespace(\"GEOquery\", quietly = TRUE)) {     if (!requireNamespace(\"BiocManager\", quietly = TRUE)){         install.packages(\"BiocManager\")     }     BiocManager::install(\"GEOquery\") }"},{"path":"http://sistm.github.io/TcGSA/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Boris P Hejblum. Author, maintainer. Damien Chimits. Author. Anthony Devaux. Author.","code":""},{"path":"http://sistm.github.io/TcGSA/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hejblum BP, Skinner J, Thiebaut R (2015). Time-Course Gene Set Analysis Longitudinal Gene Expression Data. PLoS Comput Biol 11(6): e1004310. doi: 10.1371/journal.pcbi.1004310","code":"@Article{,   title = {Time-Course Gene Set Analysis for Longitudinal Gene Expression Data},   author = {Boris P Hejblum and Jason Skinner and Rodolphe Thi{\\'e}baut},   journal = {PLoS Computational Biology},   year = {2015},   volume = {11},   number = {6},   pages = {e1004310},   doi = {10.1371/journal.pcbi.1004310},   url = {https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1004310},   note = {R package version 0.12.6}, }"},{"path":[]},{"path":"http://sistm.github.io/TcGSA/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Time-Course Gene Set Analysis","text":"TcGSA package performs Time-course Gene Set Analysis microarray data, provide nice representations results. top CRAN help pdf-file, following article explains TcGSA : Hejblum, BP, Skinner, J, & Thiébaut, R (2015). Time-Course Gene Set Analysis Longitudinal Gene Expression Data. PLOS Computational Biology, 11(6):e1004310. <doi: 10.1371/journal.pcbi.1004310>","code":""},{"path":"http://sistm.github.io/TcGSA/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Time-Course Gene Set Analysis","text":"TcGSA imports multtest package available CRAN, available Bioconductor repository. installing TcGSA, sure multtest package installed. , can running following: easiest way get TcGSA install CRAN: get development version GitHub:","code":"if (!requireNamespace(\"BiocManager\", quietly = TRUE)) {     install.packages(\"BiocManager\") } BiocManager::install(\"multtest\") install.packages(\"TcGSA\") #install.packages(\"devtools\") devtools::install_github(\"sistm/TcGSA\")"},{"path":"http://sistm.github.io/TcGSA/index.html","id":"microarrays-vs-rna-seq","dir":"","previous_headings":"","what":"Microarrays vs RNA-seq","title":"Time-Course Gene Set Analysis","text":"TcGSA relies Gaussian assumption expression data, suitable normalized microarray data. Due count heteroskedastic nature, RNA-seq data need handled differently TcGSA deal RNA-seq data. RNA-seq data, please look Bioconductor package dearseq incorporates similar functionality analyzing RNA-seq data. – Boris Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA-internal.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal TcGSA Functions — TcGSA-internal","title":"Internal TcGSA Functions — TcGSA-internal","text":"Internal TcGSA functions","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA-internal.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Internal TcGSA Functions — TcGSA-internal","text":"called user. MYheatmap.2 adapted function heatmap.2  included package gplots, authored :  Andy Liaw, original;  R. Gentleman, M. Maechler, W. Huber, G. Warnes, revisions; GPL-2 license.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA-package.html","id":null,"dir":"Reference","previous_headings":"","what":"Time-course Gene Set Analysis — TcGSA-package","title":"Time-course Gene Set Analysis — TcGSA-package","text":"package implements TcGSA, algorithm analyze longitudinal gene-expression data gene set level.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Time-course Gene Set Analysis — TcGSA-package","text":"main function package TcGSA.LR performs Time-course Gene Set Analysis, provide nice representations results (see plot.TcGSA plot1GS).","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Time-course Gene Set Analysis — TcGSA-package","text":"Hejblum BP, Skinner J, Thiebaut R, (2015) Time-Course Gene Set Analysis Longitudinal Gene Expression Data. PLOS Comput. Biol. 11(6):e1004310. doi: 10.1371/journal.pcbi.1004310","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Time-course Gene Set Analysis — TcGSA-package","text":"Boris P. Hejblum, Damien Chimits --- Maintainer: Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.html","id":null,"dir":"Reference","previous_headings":"","what":"Computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR","title":"Computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR","text":"function computes Likelihood Ratios gene sets scrutiny, well estimations genes dynamics inside gene sets mixed models.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR","text":"","code":"TcGSA.LR(   expr,   gmt,   design,   subject_name = \"Patient_ID\",   time_name = \"TimePoint\",   crossedRandom = FALSE,   covariates_fixed = \"\",   time_covariates = \"\",   time_func = \"linear\",   group_name = \"\",   separateSubjects = FALSE,   minGSsize = 10,   maxGSsize = 500 )  # S3 method for TcGSA print(x, ...)"},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR","text":"expr matrix dataframe gene expression.  dimension \\(n\\)x\\(p\\), \\(p\\) samples column \\(n\\) genes row. gmt gmt object containing gene sets definition.  See GSA.read.gmt definition  www.software.broadinstitute.org. design matrix dataframe containing experimental variables used model, namely subject_name, time_name, covariates_fixed  time_covariates applicable.  dimension \\(p\\)x\\(m\\)  row order columns expr. subject_name name factor variable design contains information  repetition units used mixed model, patient identifiers instance.   Default 'Patient_ID'.  See Details. time_name name numeric variable design contains  information time replicates (time points gene  expression measured).  Default 'TimePoint'.  See Details. crossedRandom logical flag indicating whether random effects subjects time points modeled one crossed random effect two separated random effects.   Default FALSE. See details. covariates_fixed character vector names numeric factor variables design  matrix appear fixed effects model.  See details. Default \"\", corresponds covariates model. time_covariates character vector names numeric factor variables design  matrix appear fixed effects interaction time_name  variable model.  See details.  Default \"\", corresponds  covariates model. time_func form time trend. Can either one \"linear\", \"cubic\", \"splines\" specified user, column name  factor variable design. specified user,  must expression using names variables design matrix  three following operators: +, *, / .  \"splines\" form corresponds natural cubic B-splines  (see also ns).  timepoints,  \"linear\" form sufficient. Otherwise, \"cubic\" form  parsimonious \"splines\" form, sufficiently flexible. column name factor variable design supplied,  time considered discrete analysis. user specify formula using column names design, factor numeric variables can used. group_name case several treatment groups, name factor variable  design matrix.  indicates treatment group sample belongs .  Default \"\", means one  treatment group.  See Details. separateSubjects logical flag indicating analysis identifies gene sets discriminates patients rather gene sets significant trend time.  Default FALSE.  See Details. minGSsize minimum number genes gene set.  less genes number one gene sets scrutiny, Likelihood Ratio gene set computed (mixed model fitted). Default 10 genes minimum. maxGSsize maximum number genes gene set.  genes number one gene sets scrutiny, Likelihood Ratio gene set computed (mixed model fitted).  avoid long computation times.  Default 500 genes maximum. x object class 'TcGSA'. ... arguments passed methods.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR","text":"TcGSA.LR returns tcgsa object, list 5 following elements: fit data frame contains 3 following variables: LR: likelihood ratio model null hypothesis model alternative hypothesis. CVG_H0: convergence status model null hypothesis. CVG_H1: convergence status model alternative hypothesis. time_func: character string passing along value time_func argument used call. GeneSets_gmt: gmt object passing along value gmt argument used call. group.var: factor passing along group_name variable design matrix. separateSubjects: logical flag passing along value separateSubjects argument used call. Estimations: list 3 dimensions arrays.  element list (.e. array) corresponds estimations gene expression dynamics gene sets scrutiny (obtained mixed models).  first dimension arrays genes included concerned gene set, second dimension Patient_ID, third dimension TimePoint.  values inside arrays estimated gene expressions. time_DF: degree freedom natural splines functions","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR","text":"Time-course Gene Set Analysis aims identifying gene sets stable time, either homogeneously heterogeneously (see Hejblum et al, 2012)terms probes.  argument separateSubjects TRUE, instead identifying gene sets significant trend time, TcGSA identifies gene sets significantly different trends time depending Subjects.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR","text":"Hejblum BP, Skinner J, Thiebaut R, (2015)  Time-Course Gene Set Analysis Longitudinal Gene Expression Data.  PLOS Comput. Biol. 11(6):e1004310. doi: 10.1371/journal.pcbi.1004310","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR","text":"Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR","text":"","code":"if(interactive()){ data(data_simu_TcGSA)  tcgsa_sim_1grp <- TcGSA.LR(expr=expr_1grp, gmt=gmt_sim, design=design,                            subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=FALSE) tcgsa_sim_1grp summary(tcgsa_sim_1grp)  plot(x=tcgsa_sim_1grp, expr=expr_1grp,      Subject_ID=design$Patient_ID, TimePoint=design$TimePoint,     baseline=1,      B=100,     time_unit=\"H\"     )         tcgsa_sim_2grp <- TcGSA.LR(expr=expr_2grp, gmt=gmt_sim, design=design,                           subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=FALSE,                            group_name=\"group.var\") tcgsa_sim_2grp  }"},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parallel computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR.parallel","title":"Parallel computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR.parallel","text":"parallel version function TcGSA.LR used cluster computing processors.  function computes Likelihood Ratios gene sets scrutiny, well estimations genes dynamics inside gene sets mixed models.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parallel computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR.parallel","text":"","code":"TcGSA.LR.parallel(   Ncpus,   type_connec,   expr,   gmt,   design,   subject_name = \"Patient_ID\",   time_name = \"TimePoint\",   crossedRandom = FALSE,   covariates_fixed = \"\",   time_covariates = \"\",   time_func = \"linear\",   group_name = \"\",   separateSubjects = FALSE,   minGSsize = 10,   maxGSsize = 500,   monitorfile = \"\" )"},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parallel computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR.parallel","text":"Ncpus number processors available. type_connec type connection processors. Supported cluster types \"SOCK\", \"PVM\", \"MPI\", \"NWS\". See also makeCluster. expr matrix dataframe gene expression.  dimension \\(n\\)x\\(p\\), \\(p\\) samples column \\(n\\) genes row. gmt gmt object containing gene sets definition.  See GSA.read.gmt definition  www.software.broadinstitute.org. design matrix dataframe containing experimental variables used model, namely subject_name, time_name, covariates_fixed  time_covariates applicable.  dimension \\(p\\)x\\(m\\)  row order columns expr. subject_name name factor variable design contains information  repetition units used mixed model, patient identifiers instance.   Default 'Patient_ID'.  See Details. time_name name numeric factor variable design contains  information time replicates (time points gene  expression measured).  Default 'TimePoint'.  See Details. crossedRandom logical flag indicating whether random effects subjects time points modeled one crossed random effect two separated random effects.   Default FALSE. See details. covariates_fixed character vector names numeric factor variables design  matrix appear fixed effects model.  See details. Default \"\", corresponds covariates model. time_covariates name numeric variable design contains  information time replicates (time points gene  expression measured).  Default 'TimePoint'.  See Details. time_func form time trend. Can either one \"linear\", \"cubic\", \"splines\" specified user, column name  factor variable design. specified user,  must expression using names variables design matrix  three following operators: +, *, / .  \"splines\" form corresponds natural cubic B-splines  (see also ns).  timepoints,  \"linear\" form sufficient. Otherwise, \"cubic\" form  parsimonious \"splines\" form, sufficiently flexible. column name factor variable design supplied,  time considered discrete analysis. user specify formula using column names design, factor numeric variables can used. group_name case several treatment groups, name factor variable  design matrix.  indicates treatment group sample belongs .  Default \"\", means one  treatment group.  See Details. separateSubjects logical flag indicating analysis identifies gene sets discriminates patients rather gene sets significant trend time.  Default FALSE.  See Details. minGSsize minimum number genes gene set.  less genes number one gene sets scrutiny, Likelihood Ratio gene set computed (mixed model fitted). Default 10 genes minimum. maxGSsize maximum number genes gene set.  genes number one gene sets scrutiny, Likelihood Ratio gene set computed (mixed model fitted).  avoid long computation times.  Default 500 genes maximum. monitorfile writable connections character string naming file write ,  monitor progress analysis.   Default \"\" monitoring.  See Details.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parallel computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR.parallel","text":"TcGSA.LR returns tcgsa object, list 5 following elements: fit data frame contains 3 following variables: LR: likelihood ratio model null hypothesis model alternative hypothesis. CVG_H0: convergence status model null hypothesis. CVG_H1: convergence status model alternative hypothesis. time_func: character string passing along value time_func argument used call. GeneSets_gmt: gmt object passing along value gmt argument used call. group.var: factor passing along group_name variable design matrix. separateSubjects: logical flag passing along value separateSubjects argument used call. Estimations: list 3 dimensions arrays.  element list (.e. array) corresponds estimations gene expression dynamics gene sets scrutiny (obtained mixed models).  first dimension arrays genes included concerned gene set, second dimension Patient_ID, third dimension TimePoint.  values inside arrays estimated gene expressions. time_DF: degree freedom natural splines functions","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.parallel.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Parallel computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR.parallel","text":"Time-course Gene Set Analysis aims identifying gene sets stable time, either homogeneously heterogeneously (see Hejblum et al, 2012) terms probes.  argument separatePatients TRUE, instead identifying gene sets significant trend time (possibly probes heterogeneity trend), TcGSA identifies gene sets significantly different trends time depending patient. monitorfile argument character string naming file write , case new file exist yet, new file created. line written time one gene sets scrutiny analyzed (.e. two mixed models fitted, see TcGSA.LR) one parallelized processors.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.parallel.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Parallel computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR.parallel","text":"Hejblum BP, Skinner J, Thiebaut R, (2015)  Time-Course Gene Set Analysis Longitudinal Gene Expression Data.  PLOS Comput. Biol. 11(6):e1004310. doi: 10.1371/journal.pcbi.1004310","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.parallel.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Parallel computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR.parallel","text":"Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/TcGSA.LR.parallel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parallel computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR.parallel","text":"","code":"if(interactive()){ data(data_simu_TcGSA)  tcgsa_sim_1grp <- TcGSA.LR(expr=expr_1grp, gmt=gmt_sim, design=design,                            subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=FALSE)            library(doParallel) tcgsa_sim_1grp_par <- TcGSA.LR.parallel(Ncpus = 2, type_connec = 'SOCK',                             expr=expr_1grp, gmt=gmt_sim, design=design,                              subject_name=\"Patient_ID\", time_name=\"TimePoint\",                             time_func=\"linear\", crossedRandom=FALSE,                              separateSubjects=TRUE)  summary(tcgsa_sim_1grp) summary(tcgsa_sim_1grp_par) }"},{"path":"http://sistm.github.io/TcGSA/reference/chisqmix.html","id":null,"dir":"Reference","previous_headings":"","what":"Chi-Squared Mixtures Distribution — rchisqmix","title":"Chi-Squared Mixtures Distribution — rchisqmix","text":"Density, distribution function, quantile function random generation mixtures chi-squared distributions corresponds null  distribution Likelihood Ratio 2 nested mixed models.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/chisqmix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Chi-Squared Mixtures Distribution — rchisqmix","text":"","code":"rchisqmix(n, s, q)  dchisqmix(x, s, q)  qchisqmix(p, s, q)  pchisqmix(quant, s, q, lower.tail = TRUE)"},{"path":"http://sistm.github.io/TcGSA/reference/chisqmix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Chi-Squared Mixtures Distribution — rchisqmix","text":"n number observations. s number fixed effects tested. q number random effects tested. x, quant quantile. p probability. lower.tail logical; TRUE (default), probabilities \\(P[X \\le x]\\); otherwise, \\(P[X > x]\\).","code":""},{"path":"http://sistm.github.io/TcGSA/reference/chisqmix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Chi-Squared Mixtures Distribution — rchisqmix","text":"vector random independent observations \\(\\chi^2\\) mixture identified values s q.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/chisqmix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Chi-Squared Mixtures Distribution — rchisqmix","text":"approximate null distribution likelihood ratio 2 nested mixed models, fixed random effects tested simultaneously, specific mixture \\(\\chi^2\\) distributions [Self & Liang (1987), Stram & Lee (1994) Stram & Lee (1995)].  depends number random effects number fixed effects tested simultaneously:  $$LRT_{H_0}\\sim\\sum_{k=q}^{q+r}{{r}\\choose{k-q}}2^{-r}\\chi^2_{(k)}$$","code":""},{"path":"http://sistm.github.io/TcGSA/reference/chisqmix.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Chi-Squared Mixtures Distribution — rchisqmix","text":"Self, S. G. Liang, K., 1987, Asymptotic properties maximum likelihood estimators likelihood ratio tests nonstandard conditions, Journal American Statistical Association 82: 605--610. Stram, D. O. Lee, J. W., 1994, Variance components testing longitudinal mixed effects model, Biometrics 50: 1171--1177. Stram, D. O. Lee, J. W., 1995, Corrections \"Variance components testing longitudinal mixed effects model\" Stram, D. O. Lee, J. W.; 50: 1171--1177 (1994), Biometrics 51: 1196.","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/chisqmix.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Chi-Squared Mixtures Distribution — rchisqmix","text":"Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/chisqmix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Chi-Squared Mixtures Distribution — rchisqmix","text":"","code":"library(graphics) library(stats)  sample_mixt <- rchisqmix(n=1000, s=3, q=3) plot(density(sample_mixt))"},{"path":"http://sistm.github.io/TcGSA/reference/clustTrend.html","id":null,"dir":"Reference","previous_headings":"","what":"Cluster the genes dynamics into different dominant trends. — clustTrend","title":"Cluster the genes dynamics into different dominant trends. — clustTrend","text":"function clusters genes dynamics one gene sets different dominant trends.  optimal number clusters computed thanks gap statistics.  See clusGap.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/clustTrend.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cluster the genes dynamics into different dominant trends. — clustTrend","text":"","code":"clustTrend(   tcgs,   expr,   Subject_ID,   TimePoint,   threshold = 0.05,   myproc = \"BY\",   nbsimu_pval = 1e+06,   baseline = NULL,   only.signif = TRUE,   group.var = NULL,   Group_ID_paired = NULL,   ref = NULL,   group_of_interest = NULL,   FUNcluster = NULL,   clustering_metric = \"euclidian\",   clustering_method = \"ward\",   B = 100,   max_trends = 4,   aggreg.fun = \"median\",   na.rm.aggreg = TRUE,   trend.fun = \"median\",   methodOptiClust = \"firstSEmax\",   indiv = \"genes\",   verbose = TRUE )  # S3 method for ClusteredTrends print(x, ...)  # S3 method for ClusteredTrends plot(x, ...)"},{"path":"http://sistm.github.io/TcGSA/reference/clustTrend.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cluster the genes dynamics into different dominant trends. — clustTrend","text":"tcgs tcgsa object clustTrend, ClusteredTrends object print.ClusteredTrends plot.ClusteredTrends. expr either matrix dataframe gene expression upon dynamics calculated, list gene sets estimation gene expression.  case matrix dataframe, dimension \\(n\\) x \\(p\\), \\(p\\) sample column \\(n\\) genes row. case list, length correspond number gene sets scrutiny element 3 dimension array estimated gene expression, list returned 'Estimations' element TcGSA.LR.  See details. Subject_ID factor length \\(p\\) order columns expr (dataframe) contains patient identifier sample. TimePoint numeric vector factor length \\(p\\) order Subject_ID columns expr (dataframe), contains time points gene expression measured. threshold threshold FDR FWER controlled. myproc vector character strings containing names multiple testing procedures adjusted p-values computed. vector include following: \"Bonferroni\", \"Holm\", \"Hochberg\", \"SidakSS\", \"SidakSD\", \"BH\", \"\", \"ABH\", \"TSBH\". See mt.rawp2adjp details.  Default \"\", Benjamini & Yekutieli (2001) step-FDR-controlling procedure (general dependency structures).  order control FWER(case analysis hypothesis confirmation exploration expression data), recommend use \"Holm\", Holm (1979) step-adjusted p-values strong control FWER. nbsimu_pval number observations null distribution generated order compute p-values.  Default 1e+06. baseline character string value TimePoint can used baseline.  Default NULL, case time point used baseline value gene expression.  NULL comparing several treatment groups. .signif logical flag analyzing trends significant gene sets.  FALSE, gene sets gmt object contained x clustered.  Default TRUE. group.var case several treatment groups, factor length \\(p\\) order Timepoint, Subject_ID columns expr.  indicates treatment group sample belongs .  Default NULL, means one treatment group. Group_ID_paired character vector length \\(p\\) order Timepoint,  Subject_ID, group.var columns expr.  argument must NULL case paired analysis, must NULL otherwise.  Default NULL. ref group used reference case several treatment groups.  Default NULL, means reference first group alphabetical order labels group.var. group_of_interest group interest, dynamics computed case several treatment groups.  Default NULL, means group interest second group alphabetical order labels group.var. FUNcluster clustering function used agglomerate genes trends.  Default NULL, hierarchical clustering performed via function agnes, using metric clustering_metric method clustering_method.  See clusGap clustering_metric character string specifying metric used calculating dissimilarities observations hierarchical clustering FUNcluster NULL.  currently available options \"euclidean\" \"manhattan\".  Default \"euclidean\".  See agnes.  Also, \"sts\" option  available TcGSA.  implements 'Short Time Series' distance  [Moller-Levet et al., Fuzzy Clustering short time series unevenly distributed  sampling points, Advances Intelligent Data Analysis V:330-340 Springer, 2003] designed specifically clustering time series. clustering_method character string defining agglomerative method used hierarchical clustering FUNcluster NULL.  six methods implemented \"average\" ([unweighted pair-]group average method, UPGMA), \"single\" (single linkage), \"complete\" (complete linkage), \"ward\" (Ward's method), \"weighted\" (weighted average linkage).  Default \"ward\".  See agnes. B integer specifying number Monte Carlo (\"bootstrap\") samples used compute gap statistics.  Default 500.  See clusGap. max_trends integer specifying maximum number different clusters tested.  Default 4. aggreg.fun character string \"mean\", \"median\" name defined statistics function returns single numeric value.  specifies function used aggregate observations clustering.  Default median.  Default \"median\". na.rm.aggreg logical flag indicating whether NA remove prevent  propagation aggreg.fun. Can useful set TRUE  unbalanced design generate structural NAs  $Estimations. Default TRUE. trend.fun character string \"mean\", \"median\" name function returns single numeric value.  specifies function used calculate trends identified clustered.  Default median. methodOptiClust character string indicating \"optimal\" number clusters computed gap statistics standard deviations. Possible values \"globalmax\", \"firstmax\", \"Tibs2001SEmax\", \"firstSEmax\" \"globalSEmax\". Default \"firstSEmax\".  See 'method' clusGap, Details Tibshirani et al., 2001 References. indiv character string indicating unit observations aggregated (aggreg.fun) clustering.  Possible values \"genes\" \"patients\".  Default \"genes\". verbose logical flag enabling verbose messages track computing status function.  Default TRUE. x object class 'ClusteredTrends'. ... arguments passed methods.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/clustTrend.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cluster the genes dynamics into different dominant trends. — clustTrend","text":"object class ClusteredTrends list 4 following components: NbClust vector contains optimal number clusters analyzed gene sets. ClustsMeds list length NsClust (number analyzed gene sets). element list data frame, many column optimal number clusters corresponding gene sets cluster.  column data frame contains median trend values corresponding cluster. GenesPartition list length NsClust (number analyzed gene sets).  element list vector gives partition genes inside corresponding gene set. MaxNbClust integer storing maximum number different clusters tested, given argument 'max_trends'.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/clustTrend.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Cluster the genes dynamics into different dominant trends. — clustTrend","text":"expr matrix dataframe, genes dynamics clustered \"original\" data.  hand, expr list returned 'Estimations' element TcGSA.LR, dynamics computed estimations made TcGSA.LR function. function uses Gap statistics determine optimal number clusters plotted gene set.  See clusGap.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/clustTrend.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Cluster the genes dynamics into different dominant trends. — clustTrend","text":"Tibshirani, R., Walther, G. Hastie, T., 2001, Estimating number data clusters via Gap statistic, Journal Royal Statistical Society, Series B (Statistical Methodology), 63, 2: 41--423.","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/clustTrend.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Cluster the genes dynamics into different dominant trends. — clustTrend","text":"Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/clustTrend.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cluster the genes dynamics into different dominant trends. — clustTrend","text":"","code":"if(interactive()){ data(data_simu_TcGSA)  tcgsa_sim_1grp <- TcGSA.LR(expr=expr_1grp, gmt=gmt_sim, design=design,                            subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=FALSE)   CT <- clustTrend(tcgsa_sim_1grp,     expr=expr_1grp, Subject_ID=design$Subject_ID, TimePoint=design$TimePoint) CT plot(CT)  CT$NbClust CT$NbClust[\"Gene set 5\"] CT$ClustMeds[[\"Gene set 4\"]] CT$ClustMeds[[\"Gene set 5\"]] }"},{"path":"http://sistm.github.io/TcGSA/reference/data_simu_TcGSA.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated Data for TcGSA — data_simu_TcGSA","title":"Simulated Data for TcGSA — data_simu_TcGSA","text":"Simulated data 5 gene sets 50 genes .  Gene expression simulated 5 time points 10 patients.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/data_simu_TcGSA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated Data for TcGSA — data_simu_TcGSA","text":"","code":"data(data_simu_TcGSA)"},{"path":"http://sistm.github.io/TcGSA/reference/data_simu_TcGSA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulated Data for TcGSA — data_simu_TcGSA","text":"expr_1grp See Details. expr_2grp See Details. design data frame 5 variables: Patient_ID: factor contains patient ID. TimePoint: numeric vector factor contains time points gene expression measured. sample_name: character vector names sample (corresponding names columns expr_1grp expr_2grp). group.var: factor indicates 2 treatment groups sample belongs . Group_paired_ID random paired identifier paired couples (one 2 treatment groups) patients. gmt_sim gmt object containing gene sets definition.  See GSA.read.gmt GMT definition www.broadinstitute.org.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/data_simu_TcGSA.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulated Data for TcGSA — data_simu_TcGSA","text":"expr_1grp patients belong unique treatment group.  first 2 gene sets simulated null hypothesis.  gene sets 3 4 simulated alternative hypothesis significant homogeneous time trend within gene set.  gene set 5 simulated alternative hypothesis significant heterogeneous time trends within gene set. expr_2grp patients belong 2 treatment groups.  5 first patients belong treatment group 'T', 5 patients belong treatment group 'C'.  first 2 gene sets simulated null hypothesis difference time trend 2 treatment groups.  gene sets 3 4 simulated alternative hypothesis significantly different homogeneous time trends within gene set 2 treatment groups.  gene set 5 simulated alternative hypothesis significantly different heterogeneous time trends 2 treatment groups within gene set.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/data_simu_TcGSA.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Simulated Data for TcGSA — data_simu_TcGSA","text":"simulated data.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/data_simu_TcGSA.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulated Data for TcGSA — data_simu_TcGSA","text":"Boris P. Hejblum","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/data_simu_TcGSA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulated Data for TcGSA — data_simu_TcGSA","text":"","code":"data(data_simu_TcGSA) summary(expr_1grp) #>        1                2                3                4          #>  Min.   : 3.205   Min.   : 3.309   Min.   : 3.367   Min.   : 3.330   #>  1st Qu.: 5.251   1st Qu.: 5.299   1st Qu.: 5.184   1st Qu.: 5.090   #>  Median : 6.256   Median : 6.300   Median : 6.172   Median : 6.156   #>  Mean   : 6.420   Mean   : 6.481   Mean   : 6.413   Mean   : 6.407   #>  3rd Qu.: 7.524   3rd Qu.: 7.600   3rd Qu.: 7.604   3rd Qu.: 7.674   #>  Max.   :11.231   Max.   :10.798   Max.   :10.278   Max.   :11.288   #>        5                6                7                8          #>  Min.   : 3.234   Min.   : 3.363   Min.   : 3.399   Min.   : 3.427   #>  1st Qu.: 4.977   1st Qu.: 5.233   1st Qu.: 5.270   1st Qu.: 5.201   #>  Median : 6.048   Median : 6.279   Median : 6.247   Median : 6.149   #>  Mean   : 6.400   Mean   : 6.483   Mean   : 6.442   Mean   : 6.468   #>  3rd Qu.: 7.927   3rd Qu.: 7.734   3rd Qu.: 7.689   3rd Qu.: 7.761   #>  Max.   :10.522   Max.   :10.278   Max.   :10.181   Max.   :10.172   #>        9                10               11               12         #>  Min.   : 3.395   Min.   : 3.172   Min.   : 3.395   Min.   : 3.442   #>  1st Qu.: 5.177   1st Qu.: 5.033   1st Qu.: 5.193   1st Qu.: 5.198   #>  Median : 6.121   Median : 5.998   Median : 6.218   Median : 6.246   #>  Mean   : 6.458   Mean   : 6.455   Mean   : 6.368   Mean   : 6.406   #>  3rd Qu.: 7.800   3rd Qu.: 7.858   3rd Qu.: 7.610   3rd Qu.: 7.705   #>  Max.   :10.271   Max.   :10.351   Max.   :10.004   Max.   :10.384   #>        13               14               15               16         #>  Min.   : 3.415   Min.   : 3.416   Min.   : 3.251   Min.   : 3.349   #>  1st Qu.: 5.162   1st Qu.: 5.021   1st Qu.: 4.867   1st Qu.: 5.401   #>  Median : 6.094   Median : 6.102   Median : 5.923   Median : 6.287   #>  Mean   : 6.373   Mean   : 6.380   Mean   : 6.357   Mean   : 6.468   #>  3rd Qu.: 7.667   3rd Qu.: 7.707   3rd Qu.: 7.802   3rd Qu.: 7.617   #>  Max.   :11.174   Max.   :10.410   Max.   :10.164   Max.   :10.382   #>        17               18               19               20         #>  Min.   : 3.375   Min.   : 2.718   Min.   : 3.398   Min.   : 3.334   #>  1st Qu.: 5.348   1st Qu.: 5.275   1st Qu.: 5.187   1st Qu.: 5.168   #>  Median : 6.310   Median : 6.253   Median : 6.227   Median : 6.171   #>  Mean   : 6.438   Mean   : 6.430   Mean   : 6.413   Mean   : 6.434   #>  3rd Qu.: 7.617   3rd Qu.: 7.609   3rd Qu.: 7.705   3rd Qu.: 7.755   #>  Max.   :10.239   Max.   :10.525   Max.   :10.353   Max.   :10.352   #>        21               22               23               24         #>  Min.   : 3.210   Min.   : 3.281   Min.   : 3.260   Min.   : 3.319   #>  1st Qu.: 5.263   1st Qu.: 5.274   1st Qu.: 5.151   1st Qu.: 5.096   #>  Median : 6.347   Median : 6.321   Median : 6.239   Median : 6.206   #>  Mean   : 6.498   Mean   : 6.518   Mean   : 6.481   Mean   : 6.480   #>  3rd Qu.: 7.884   3rd Qu.: 7.891   3rd Qu.: 7.708   3rd Qu.: 7.939   #>  Max.   :10.680   Max.   :10.096   Max.   :11.141   Max.   :10.521   #>        25               26               27               28         #>  Min.   : 3.189   Min.   : 3.317   Min.   : 3.372   Min.   : 3.359   #>  1st Qu.: 5.051   1st Qu.: 5.362   1st Qu.: 5.279   1st Qu.: 5.269   #>  Median : 6.078   Median : 6.388   Median : 6.294   Median : 6.240   #>  Mean   : 6.480   Mean   : 6.476   Mean   : 6.447   Mean   : 6.465   #>  3rd Qu.: 7.916   3rd Qu.: 7.702   3rd Qu.: 7.682   3rd Qu.: 7.721   #>  Max.   :10.652   Max.   :10.468   Max.   :10.251   Max.   :10.418   #>        29               30               31               32         #>  Min.   : 3.429   Min.   : 3.287   Min.   : 3.339   Min.   : 3.350   #>  1st Qu.: 5.197   1st Qu.: 5.055   1st Qu.: 5.223   1st Qu.: 5.212   #>  Median : 6.136   Median : 6.078   Median : 6.158   Median : 6.258   #>  Mean   : 6.442   Mean   : 6.440   Mean   : 6.364   Mean   : 6.388   #>  3rd Qu.: 7.759   3rd Qu.: 7.826   3rd Qu.: 7.456   3rd Qu.: 7.498   #>  Max.   :10.677   Max.   :11.181   Max.   :10.621   Max.   :10.629   #>        33               34               35               36         #>  Min.   : 3.412   Min.   : 3.371   Min.   : 3.219   Min.   : 3.243   #>  1st Qu.: 5.181   1st Qu.: 5.007   1st Qu.: 5.070   1st Qu.: 5.306   #>  Median : 6.171   Median : 6.093   Median : 5.971   Median : 6.283   #>  Mean   : 6.381   Mean   : 6.335   Mean   : 6.360   Mean   : 6.441   #>  3rd Qu.: 7.606   3rd Qu.: 7.603   3rd Qu.: 7.612   3rd Qu.: 7.579   #>  Max.   :10.165   Max.   :10.578   Max.   :10.541   Max.   :10.652   #>        37              38               39               40         #>  Min.   :3.354   Min.   : 3.299   Min.   : 3.321   Min.   : 3.269   #>  1st Qu.:5.313   1st Qu.: 5.223   1st Qu.: 5.158   1st Qu.: 5.138   #>  Median :6.191   Median : 6.219   Median : 6.185   Median : 6.067   #>  Mean   :6.432   Mean   : 6.449   Mean   : 6.459   Mean   : 6.456   #>  3rd Qu.:7.684   3rd Qu.: 7.678   3rd Qu.: 7.720   3rd Qu.: 7.751   #>  Max.   :9.953   Max.   :10.027   Max.   :10.336   Max.   :10.254   #>        41               42               43               44         #>  Min.   : 3.125   Min.   : 3.188   Min.   : 3.235   Min.   : 3.218   #>  1st Qu.: 5.149   1st Qu.: 5.192   1st Qu.: 5.143   1st Qu.: 5.098   #>  Median : 6.191   Median : 6.185   Median : 6.113   Median : 6.052   #>  Mean   : 6.381   Mean   : 6.407   Mean   : 6.377   Mean   : 6.401   #>  3rd Qu.: 7.664   3rd Qu.: 7.656   3rd Qu.: 7.758   3rd Qu.: 7.809   #>  Max.   :10.375   Max.   :10.268   Max.   :10.265   Max.   :10.283   #>        45               46               47               48         #>  Min.   : 3.223   Min.   : 3.190   Min.   : 3.264   Min.   : 3.237   #>  1st Qu.: 4.916   1st Qu.: 5.212   1st Qu.: 5.264   1st Qu.: 5.102   #>  Median : 6.037   Median : 6.260   Median : 6.234   Median : 6.174   #>  Mean   : 6.363   Mean   : 6.378   Mean   : 6.391   Mean   : 6.404   #>  3rd Qu.: 7.856   3rd Qu.: 7.489   3rd Qu.: 7.482   3rd Qu.: 7.660   #>  Max.   :10.220   Max.   :10.504   Max.   :10.623   Max.   :10.459   #>        49               50         #>  Min.   : 3.252   Min.   : 3.247   #>  1st Qu.: 5.080   1st Qu.: 5.075   #>  Median : 6.113   Median : 6.002   #>  Mean   : 6.397   Mean   : 6.364   #>  3rd Qu.: 7.733   3rd Qu.: 7.839   #>  Max.   :10.596   Max.   :10.508   summary(design) #>    Patient_ID   TimePoint  Sample_name group.var Group_ID_paired #>  P1     : 5   Min.   :1   1      : 1   C:25      cpl1:10         #>  P10    : 5   1st Qu.:2   10     : 1   T:25      cpl2:10         #>  P2     : 5   Median :3   11     : 1             cpl3:10         #>  P3     : 5   Mean   :3   12     : 1             cpl4:10         #>  P4     : 5   3rd Qu.:4   13     : 1             cpl5:10         #>  P5     : 5   Max.   :5   14     : 1                             #>  (Other):20               (Other):44                             gmt_sim #> $genesets #> $genesets[[1]] #>  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 #> [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 #>  #> $genesets[[2]] #>  [1]  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69 #> [20]  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88 #> [39]  89  90  91  92  93  94  95  96  97  98  99 100 #>  #> $genesets[[3]] #>  [1] 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 #> [20] 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 #> [39] 139 140 141 142 143 144 145 146 147 148 149 150 #>  #> $genesets[[4]] #>  [1] 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 #> [20] 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 #> [39] 189 190 191 192 193 194 195 196 197 198 199 200 #>  #> $genesets[[5]] #>  [1] 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 #> [20] 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 #> [39] 239 240 241 242 243 244 245 246 247 248 249 250 #>  #>  #> $geneset.names #> [1] \"Gene set 1\" \"Gene set 2\" \"Gene set 3\" \"Gene set 4\" \"Gene set 5\" #>  #> $geneset.descriptions #> [1] \"This is a simulated gene set under H0\"                 #> [2] \"This is a simulated gene set under H0\"                 #> [3] \"This is a simulated gene set under H1 (homogeneous)\"   #> [4] \"This is a simulated gene set under H1 (homogeneous)\"   #> [5] \"This is a simulated gene set under H1 (heterogeneous)\" #>  #> attr(,\"class\") #> [1] \"GSA.genesets\""},{"path":"http://sistm.github.io/TcGSA/reference/multtest.TcGSA.html","id":null,"dir":"Reference","previous_headings":"","what":"Computing the P-value of the Likelihood Ratios Applying a Multiple Testing\nCorrection — multtest.TcGSA","title":"Computing the P-value of the Likelihood Ratios Applying a Multiple Testing\nCorrection — multtest.TcGSA","text":"function computes p-value likelihood ratios apply multiple testing correction.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/multtest.TcGSA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computing the P-value of the Likelihood Ratios Applying a Multiple Testing\nCorrection — multtest.TcGSA","text":"","code":"multtest.TcGSA(   tcgsa,   threshold = 0.05,   myproc = \"BY\",   exact = TRUE,   nbsimu_pval = 1e+06 )"},{"path":"http://sistm.github.io/TcGSA/reference/multtest.TcGSA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computing the P-value of the Likelihood Ratios Applying a Multiple Testing\nCorrection — multtest.TcGSA","text":"tcgsa TcGSA object. threshold threshold FDR FWER controlled. myproc vector character strings containing names multiple testing procedures adjusted p-values computed. vector include following: \"Bonferroni\", \"Holm\", \"Hochberg\", \"SidakSS\", \"SidakSD\", \"BH\", \"\", \"ABH\", \"TSBH\" \"none\".   \"none\" indicates adjustment multiple testing.  See mt.rawp2adjp details.  Default \"\", Benjamini & Yekutieli (2001) step-FDR-controlling procedure (general dependency structures).  order control FWER (case analysis hypothesis confirmation exploration expression data), recommend use \"Holm\", Holm (1979) step-adjusted p-values strong control FWER. exact logical flag indicating whether raw p-values computed  exact asymptotic mixture chi-square, simulated (longer better). Default TRUE preferred. nbsimu_pval number observations null distribution generated order compute p-values. Default 1e+06.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/multtest.TcGSA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computing the P-value of the Likelihood Ratios Applying a Multiple Testing\nCorrection — multtest.TcGSA","text":"multtest.TcGSA returns dataframe 5 variables.  rows correspond gene sets scrutiny.  1st column likelihood ratios LR, 2nd column convergence status model null hypothesis CVG_H0, 3rd column convergence status model alternative hypothesis CVG_H1, 4th column raw p-value mixed likelihood ratio test raw_pval, 5th column adjusted p-value mixed likelihood ratio test adj_pval.","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/multtest.TcGSA.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Computing the P-value of the Likelihood Ratios Applying a Multiple Testing\nCorrection — multtest.TcGSA","text":"Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/multtest.TcGSA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computing the P-value of the Likelihood Ratios Applying a Multiple Testing\nCorrection — multtest.TcGSA","text":"","code":"if(interactive()){ data(data_simu_TcGSA)  tcgsa_sim_1grp <- TcGSA.LR(expr=expr_1grp, gmt=gmt_sim, design=design,                            subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=FALSE)                            mtt <- multtest.TcGSA(tcgsa_sim_1grp, threshold = 0.05,                       myproc = \"BY\", nbsimu_pval = 1000) mtt }"},{"path":"http://sistm.github.io/TcGSA/reference/plot.TcGSA.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a Gene Set Trends Heatmap. — plot.TcGSA","title":"Plot a Gene Set Trends Heatmap. — plot.TcGSA","text":"function plots gene sets dynamic trends heatmap.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plot.TcGSA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a Gene Set Trends Heatmap. — plot.TcGSA","text":"","code":"# S3 method for TcGSA plot(   x,   threshold = 0.05,   myproc = \"BY\",   nbsimu_pval = 1e+06,   expr,   Subject_ID,   TimePoint,   baseline = NULL,   only.signif = TRUE,   group.var = NULL,   Group_ID_paired = NULL,   ref = NULL,   group_of_interest = NULL,   ranking = FALSE,   FUNcluster = NULL,   clustering_metric = \"euclidian\",   clustering_method = \"ward\",   B = 500,   max_trends = 4,   aggreg.fun = \"median\",   na.rm.aggreg = TRUE,   methodOptiClust = \"firstSEmax\",   indiv = \"genes\",   verbose = TRUE,   clust_trends = NULL,   N_clusters = NULL,   myclusters = NULL,   label.clusters = NULL,   prev_rowCL = NULL,   descript = TRUE,   plot = TRUE,   color.vec = c(\"darkred\", \"#D73027\", \"#FC8D59\", \"snow\", \"#91BFDB\", \"#4575B4\",     \"darkblue\"),   legend.breaks = NULL,   label.column = NULL,   time_unit = \"\",   cex.label.row = 1,   cex.label.column = 1,   margins = c(5, 25),   heatKey.size = 1,   dendrogram.size = 1,   heatmap.height = 1,   heatmap.width = 1,   cex.clusterKey = 1,   cex.main = 1,   horiz.clusterKey = TRUE,   main = NULL,   subtitle = NULL,   ... )"},{"path":"http://sistm.github.io/TcGSA/reference/plot.TcGSA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a Gene Set Trends Heatmap. — plot.TcGSA","text":"x object class'TcGSA'. threshold threshold FDR FWER controlled. myproc vector character strings containing names multiple testing procedures adjusted p-values computed. vector include following: \"Bonferroni\", \"Holm\", \"Hochberg\", \"SidakSS\", \"SidakSD\", \"BH\", \"\", \"ABH\", \"TSBH\" \"none\".   \"none\" indicates adjustment multiple testing. See mt.rawp2adjp details.  Default \"\", Benjamini & Yekutieli (2001) step-FDR-controlling procedure (general dependency structures).  order control FWER(case analysis hypothesis confirmation exploration expression data), recommend use \"Holm\", Holm (1979) step-adjusted p-values strong control FWER. nbsimu_pval number observations null distribution generated order compute p-values. Default 1e+06. expr either matrix dataframe gene expression upon dynamics calculated, list gene sets estimation gene expression.  case matrix dataframe, dimension \\(n\\) x \\(p\\), \\(p\\) sample column \\(n\\) genes row. case list, length correspond number gene sets scrutiny element 3 dimension array estimated gene expression, list returned 'Estimations' element TcGSA.LR.  See details. Subject_ID factor length \\(p\\) order columns expr (dataframe) contains patient identifier sample. Ignored expr list estimations. TimePoint numeric vector factor length \\(p\\) order Subject_ID columns expr (dataframe), contains time points gene expression measured. Ignored expr list estimations. baseline value TimePoint used baseline. Default NULL  case expression centered baseline used. .signif logical flag plotting significant gene sets. FALSE, gene sets gmt object contained x plotted.  Default TRUE. group.var case several treatment` groups, factor length \\(p\\) order Timepoint, Subject_ID, sample_name columns expr.  indicates treatment group sample belongs .  Default NULL, means one treatment group.  See Details. Group_ID_paired character vector length \\(p\\) order Timepoint, Subject_ID, sample_name, group.var columns expr.  argument must NULL case paired analysis, must NULL otherwise.  Default NULL.  See Details. ref group used reference case several treatment groups.  Default NULL, means reference first group alphabetical order labels group.var.  See Details. group_of_interest group interest, dynamics computed case several treatment groups.  Default NULL, means group interest second group alphabetical order labels group.var.  See Details. group_of_interest ~~ ranking logical flag. TRUE, gene set trends hierarchically classified, ordered decreasing Likelihood ratios. Default FALSE. FUNcluster clustering function used agglomerate genes trends.  Default NULL, hierarchical clustering performed via function agnes, using metric clustering_metric method clustering_method.  See clusGap clustering_metric character string specifying metric used calculating dissimilarities observations hierarchical clustering FUNcluster NULL.  currently available options \"euclidean\" \"manhattan\".  Default \"euclidean\".  See agnes.  Also, \"sts\" option  available TcGSA.  implements 'Short Time Series' distance  [Moller-Levet et al., Fuzzy Clustering short time series unevenly distributed  sampling points, Advances Intelligent Data Analysis V:330-340 Springer, 2003] designed specifically clustering time series. clustering_method character string defining agglomerative method used hierarchical clustering FUNcluster NULL.  six methods implemented \"average\" ([unweighted pair-]group average method, UPGMA), \"single\" (single linkage), \"complete\" (complete linkage), \"ward\" (Ward's method), \"weighted\" (weighted average linkage).  Default \"ward\".  See agnes. B integer specifying number Monte Carlo (\"bootstrap\") samples used compute gap statistics.  Default 500.  See clusGap. max_trends integer specifying maximum number different clusters tested.  Default 4. aggreg.fun character string \"mean\", \"median\" name statistics function defined returns single numeric value.  specifies function used aggregate observations clustering.  Default median.  Default \"median\". na.rm.aggreg logical flag indicating whether NA remove prevent  propagation aggreg.fun. Can useful set TRUE  unbalanced design generate structural NAs  $Estimations. Default TRUE. methodOptiClust character string indicating \"optimal\"\" number clusters computed gap statistics standard deviations. Possible values \"globalmax\", \"firstmax\", \"Tibs2001SEmax\", \"firstSEmax\" \"globalSEmax\". Default \"firstSEmax\".  See 'method' clusGap, Details Tibshirani et al., 2001 References. indiv character string indicating unit observations aggregated (aggreg.fun) clustering.  Possible values \"genes\" \"patients\".  Default \"genes\". verbose logical flag enabling verbose messages track computing status function.  Default TRUE. clust_trends object class ClusteredTrends containing already computed trends plotted gene sets.  Default NULL. N_clusters integer number clusters dynamics regrouped. cutoff clustering tree automatically calculated accordingly.  Default NULL, case dendrogram cut clusters identified. myclusters character vector colors predefined clusters represented gene sets, many levels value N_clusters. Default NULL, case clusters automatically identified colored via cutree function N_clusters argument . label.clusters N_clusters NULL, character vector length N_clusterss.  Default NULL, case N_clusters NULL, clusters simply labeled numbers. prev_rowCL hclust object, one return present plotting function (see Value) instance.  NULL, clustering calculated present plotting function tree used represent gene sets dynamics.  Default NULL. descript logical flag indicating description gene sets appear name right side plot TRUE. Default TRUE.  See Details. plot logical flag indicating whether heatmap plotted .  Default TRUE. color.vec character strings vector used define color palette used plot.  Default c(\"#D73027\", \"#FC8D59\",\"lightyellow\", \"#91BFDB\", \"#4575B4\"). legend.breaks numeric vector indicating splitting points coloring.  Default NULL, case break points spaced equally symmetrically 0. label.column vector character strings labels displayed columns (.e. time points).  Default NULL. time_unit time unit displayed (\"Y\", \"M\", \"W\", \"D\", \"H\", etc) next values TimePoint columns labels label.column NULL.  Default \"\". cex.label.row numerical value giving amount row labels text magnified relative default 1. cex.label.column numerical value giving amount column labels text magnified relative default 1. margins numeric vector length 2 containing margins (see par(mar= *)) column row names, respectively.  Default c(15, 100).  See Details. heatKey.size size color key heatmap fill.  Default 1. dendrogram.size horizontal size dendrogram.  Default 1 heatmap.height height heatmap.  Default 1 heatmap.width width heatmap.  Default 1 cex.clusterKey numerical value giving amount clusters legend text magnified relative default 1, N_clusters NULL. cex.main numerical value giving amount title text magnified relative default 1. horiz.clusterKey logical flag; TRUE, set legend clusters horizontally rather vertically.  used N_clusters argument NULL.  Default TRUE. main character string optional title.  Default NULL. subtitle character string optional subtitle.  Default NULL. ... parameters passed plotting functions.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plot.TcGSA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot a Gene Set Trends Heatmap. — plot.TcGSA","text":"object class hclust describes tree produced clustering process.  object list components: merge \\(n-1\\) \\(2\\) matrix.  Row \\(\\) merge describes merging clusters step clustering. element \\(j\\) row negative, observation -\\(j\\) merged stage.  \\(j\\) positive merge cluster formed (earlier) stage \\(j\\) algorithm.  Thus negative entries merge indicate agglomerations singletons, positive entries indicate agglomerations non-singletons. height set \\(n-1\\) real values (non-decreasing ultrametric trees).  clustering height: , value criterion associated Ward clustering method. order vector giving permutation original observations suitable plotting, sense cluster plot using ordering matrix merge crossings branches. labels gene set trends name. call call produced result clustering: hclust(d = dist(map2heat, method = \"euclidean\"), method = \"ward.D2\") method \"ward.D2\", clustering method used clustering gene set trends. dist.method \"euclidean\", distance used clustering gene set trends. legend.breaks numeric vector giving splitting points used coloring heatmap.  plot FALSE, NULL. myclusters character vector colors dynamic clusters represented gene set trends, many levels value N_clusters.  dynamic clusters represented, NULL. ddr dendrogram object reordering used heatmap.  See heatmap.2 function package  gplots. gene set.names character vector names gene sets used heatmap. clust.trends ClusteredTrends object. clustersExport data frame 2 variables containing two following variables : GeneSet: gene set trends clustered. Cluster: dynamic cluster belong . data frame order variable Cluster. data_plotted: data matrix represented heatmap","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plot.TcGSA.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot a Gene Set Trends Heatmap. — plot.TcGSA","text":"heatmap, line corresponds gene set, column time point. expr matrix dataframe, \"original\" data plotted.  hand, expr list returned 'Estimations' element TcGSA.LR, \"estimations\" made TcGSA.LR function plotted. descript FALSE, second element margins can reduced (instance use margins = c(5, 10)), much need space order display gene set names, without description. large number significant gene sets, hierarchical clustering step repeated can take minutes. speed things  (especially) playing plotting parameters nice plot, one can run clustTrend function beforehand, plug results  plot.TcGSA function via clust_trends argument.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plot.TcGSA.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Plot a Gene Set Trends Heatmap. — plot.TcGSA","text":"Hejblum BP, Skinner J, Thiebaut R, (2015)  Time-Course Gene Set Analysis Longitudinal Gene Expression Data.  PLOS Comput. Biol. 11(6): e1004310. doi: 10.1371/journal.pcbi.1004310","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/plot.TcGSA.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot a Gene Set Trends Heatmap. — plot.TcGSA","text":"Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plot.TcGSA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot a Gene Set Trends Heatmap. — plot.TcGSA","text":"","code":"if(interactive()){ data(data_simu_TcGSA)  tcgsa_sim_1grp <- TcGSA.LR(expr=expr_1grp, gmt=gmt_sim, design=design,                            subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=FALSE) summary(tcgsa_sim_1grp)  plot(x=tcgsa_sim_1grp, expr=tcgsa_sim_1grp$Estimations,      Subject_ID=design$Patient_ID, TimePoint=design$TimePoint,     baseline=1,      B=100,     time_unit=\"H\",     dendrogram.size=0.4, heatmap.width=0.8, heatmap.height=2, cex.main=0.7     )             tcgsa_sim_2grp <- TcGSA.LR(expr=expr_2grp, gmt=gmt_sim, design=design,                            subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=FALSE,                            group_name=\"group.var\") summary(tcgsa_sim_2grp)                              plot(x=tcgsa_sim_2grp, expr=expr_2grp,      Subject_ID=design$Patient_ID, TimePoint=design$TimePoint,     B=100,     time_unit=\"H\",     ) }"},{"path":"http://sistm.github.io/TcGSA/reference/plot1GS.html","id":null,"dir":"Reference","previous_headings":"","what":"Plotting a Specific Gene Set — plot1GS","title":"Plotting a Specific Gene Set — plot1GS","text":"function can plot different representations gene expression specific gene set.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plot1GS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plotting a Specific Gene Set — plot1GS","text":"","code":"plot1GS(   expr,   gmt,   Subject_ID,   TimePoint,   geneset.name,   baseline = NULL,   group.var = NULL,   Group_ID_paired = NULL,   ref = NULL,   group_of_interest = NULL,   FUNcluster = NULL,   clustering_metric = \"euclidian\",   clustering_method = \"ward\",   B = 500,   max_trends = 4,   aggreg.fun = \"median\",   na.rm.aggreg = TRUE,   trend.fun = \"median\",   methodOptiClust = \"firstSEmax\",   indiv = \"genes\",   verbose = TRUE,   clustering = TRUE,   showTrend = TRUE,   smooth = TRUE,   precluster = NULL,   time_unit = \"\",   title = NULL,   y.lab = NULL,   desc = TRUE,   lab.cex = 1,   axis.cex = 1,   main.cex = 1,   y.lab.angle = 90,   x.axis.angle = 45,   margins = 1,   line.size = 1,   y.lim = NULL,   x.lim = NULL,   gg.add = list(theme()),   plot = TRUE )"},{"path":"http://sistm.github.io/TcGSA/reference/plot1GS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plotting a Specific Gene Set — plot1GS","text":"expr either matrix dataframe gene expression upon dynamics calculated, list gene sets estimation gene expression.  case matrix dataframe, dimension \\(n\\) x \\(p\\), \\(p\\) sample column \\(n\\) genes row. case list, length correspond number gene sets scrutiny element 3 dimension array estimated gene expression, list returned 'Estimations' element TcGSA.LR.  See details. gmt gmt object containing gene sets definition.  See GSA.read.gmt definition www.software.broadinstitute.org. Subject_ID factor length \\(p\\) order columns expr (dataframe) contains patient identifier sample. TimePoint numeric vector factor length \\(p\\) order Subject_ID columns expr (dataframe), contains time points gene expression measured. geneset.name character string containing name gene set plotted, must appear \"geneset.names\" element gmt. baseline character string value TimePoint can used baseline.  Default NULL, case time point used baseline value gene expression.  NULL comparing two treatment groups. group.var case several treatment groups, factor length \\(p\\) order Timepoint, Subject_ID columns expr.  indicates treatment group sample belongs .  Default NULL, means one treatment group. Group_ID_paired character vector length \\(p\\) order Timepoint, Subject_ID, group.var columns expr.  argument must NULL case paired analysis, must NULL otherwise.  Default NULL. ref group used reference case several treatment groups.  Default NULL, means reference first group alphabetical order labels group.var.  See Details. group_of_interest group interest, dynamics computed case several treatment groups.  Default NULL, means group interest second group alphabetical order labels group.var. FUNcluster function accepts first argument matrix x second argument number clusters desired k, returns list component named 'cluster' vector length n = nrow(x) integers 1:k, determining clustering grouping n observations.  Default NULL, case hierarchical clustering performed via function agnes, using metric clustering_metric method clustering_method.  See 'FUNcluster' clusGap Details. clustering_metric character string specifying metric used calculating dissimilarities observations hierarchical clustering FUNcluster NULL.  currently available options \"euclidean\" \"manhattan\".  Default \"euclidean\".  See agnes.  Also, \"sts\" option  available TcGSA.  implements 'Short Time Series' distance  [Moller-Levet et al., Fuzzy Clustering short time series unevenly distributed  sampling points, Advances Intelligent Data Analysis V:330-340 Springer, 2003] designed specifically clustering time series. clustering_method character string defining agglomerative method used hierarchical clustering FUNcluster NULL.  six methods implemented \"average\" ([unweighted pair-]group average method, UPGMA), \"single\" (single linkage), \"complete\" (complete linkage), \"ward\" (Ward's method), \"weighted\" (weighted average linkage).  Default \"ward\".  See agnes. B integer specifying number Monte Carlo (\"bootstrap\") samples used compute gap statistics.  Default 500.  See clusGap. max_trends integer specifying maximum number different clusters tested.  Default 4. aggreg.fun character string  \"median\" \"mean\" name defined statistics function returns single numeric value.  specifies function used aggregate observations clustering.  Default \"mean\". na.rm.aggreg logical flag indicating whether NA remove prevent  propagation aggreg.fun. Can useful set TRUE  unbalanced design generate structural NAs  $Estimations. Default TRUE. trend.fun character string \"mean\" name function returns single numeric value.  specifies function used calculate trends identified clustered.  Default \"mean\". methodOptiClust character string indicating \"optimal\" number clusters computed gap statistics standard deviations. Possible values \"globalmax\", \"firstmax\", \"Tibs2001SEmax\", \"firstSEmax\" \"globalSEmax\". Default \"firstSEmax\".  See 'method' clusGap, Details Tibshirani et al., 2001 References. indiv character string indicating unit observations aggregated (aggreg.fun) clustering.  Possible values \"genes\" \"patients\".  Default \"genes\". See Details. verbose logical flag enabling verbose messages track computing status function.  Default TRUE. clustering logical flag.  FALSE, clustering representation; TRUE, lines colored according cluster belong .  Default TRUE.  See Details. showTrend logical flag.  TRUE, black line added cluster, representing corresponding trend.fun.  Default TRUE. smooth logical flag.  TRUE showTrend also TRUE, representation cluster trend.fun smoothed using cubic polynomials (see geom_smooth. Default TRUE.  moment, must accept parameter \"na.rm\" (automatically set TRUE).  might change future versions precluster vector length \\(p\\) order Subject_ID, TimePoint columns expr (dataframe), contains prior clustering subjects. Default NULL. time_unit time unit displayed (\"Y\", \"M\", \"W\", \"D\", \"H\", etc) next values TimePoint x-axis.  Default \"\", case time  scale x-axis proportional time values. title character specifying title plot.  NULL, title automatically generated, \"\", title appears.  Default NULL. y.lab character specifying annotation y axis.  NULL, annotation automatically generated, \"\", annotation appears.  Default NULL. desc logical flag. TRUE, line added title plot description gene set plotted (gmt file). Default TRUE. lab.cex numerical value giving amount lab labels text magnified relative default 1. axis.cex numerical value giving amount axis annotation text magnified relative default 1. main.cex numerical value giving amount title text magnified relative default 1. y.lab.angle numerical value ([0, 360]) giving orientation y-label text turned (anti-clockwise).  Default 90. See element_text. x.axis.angle numerical value ([0, 360]) giving orientation x-axis annotation text turned (anti-clockwise).  Default 45. margins numerical value giving amount margins reduced increased relative default 1. line.size numerical value giving amount line sizes reduced increased relative default 1. y.lim numeric vector length 2 giving range y-axis. See plot.default. x.lim numeric, create continuous scale, factor character, create discrete scale.  Observations range dropped.  See xlim. gg.add list instructions add ggplot2 instructions. See +.gg.  Default list(theme()), adds nothing plot. plot logical flag.  FALSE, plot drawn.  Default TRUE.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plot1GS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plotting a Specific Gene Set — plot1GS","text":"list 2 elements: classif: data.frame  2 following variables: ProbeID    contains IDs probes plotted gene set, Cluster containing $   cluster probe belongs . clustering FALSE, Cluster NA probes. p: ggplot object containing plot","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plot1GS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plotting a Specific Gene Set — plot1GS","text":"expr matrix dataframe, \"original\" data plotted.  hand, expr list returned 'Estimations' element TcGSA.LR, \"estimations\" made TcGSA.LR function plotted. indiv 'genes', line plot median gene expression patients. hand, indiv 'patients', line plot median patient genes expression gene set. function uses Gap statistics determine optimal number clusters plotted gene set.  See clusGap.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plot1GS.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Plotting a Specific Gene Set — plot1GS","text":"Tibshirani, R., Walther, G. Hastie, T., 2001, Estimating number data clusters via Gap statistic, Journal Royal Statistical Society, Series B (Statistical Methodology), 63, 2: 411--423.","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/plot1GS.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plotting a Specific Gene Set — plot1GS","text":"Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plot1GS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plotting a Specific Gene Set — plot1GS","text":"","code":"if(interactive()){ data(data_simu_TcGSA) tcgsa_sim_1grp <- TcGSA.LR(expr=expr_1grp, gmt=gmt_sim, design=design,                            subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=FALSE)  plot1GS(expr=expr_1grp, TimePoint=design$TimePoint,         Subject_ID=design$Patient_ID, gmt=gmt_sim,        geneset.name=\"Gene set 4\",        indiv=\"genes\", clustering=FALSE,        time_unit=\"H\",        lab.cex=0.7)  plot1GS(expr=expr_1grp, TimePoint=design$TimePoint,         Subject_ID=design$Patient_ID, gmt=gmt_sim,        geneset.name=\"Gene set 5\",        indiv=\"patients\", clustering=FALSE, baseline=1,        time_unit=\"H\",        lab.cex=0.7) } if(interactive()){       geneclusters <- plot1GS(expr=tcgsa_sim_1grp$Estimations, TimePoint=design$TimePoint,                         Subject_ID=design$Patient_ID, gmt=gmt_sim,                        geneset.name=\"Gene set 5\",                        indiv=\"genes\",                        time_unit=\"H\",                        lab.cex=0.7 ) geneclusters }  if(interactive()){ library(grDevices) library(graphics) colval <- c(hsv(0.56, 0.9, 1),            hsv(0, 0.27, 1),            hsv(0.52, 1, 0.5),            hsv(0, 0.55, 0.97),            hsv(0.66, 0.15, 1),            hsv(0, 0.81, 0.55),            hsv(0.7, 1, 0.7),            hsv(0.42, 0.33, 1) ) n <- length(colval);  y <- 1:n op <- par(mar=rep(1.5,4)) plot(y, axes = FALSE, frame.plot = TRUE,    xlab = \"\", ylab = \"\", pch = 21, cex = 8,    bg = colval, ylim=c(-1,n+1), xlim=c(-1,n+1),    main = \"Color scale\" ) par(op)  plot1GS(expr=expr_1grp, TimePoint=design$TimePoint,         Subject_ID=design$Patient_ID, gmt=gmt_sim,        geneset.name=\"Gene set 5\",        indiv=\"genes\",        time_unit=\"H\",        title=\"\",        gg.add=list(scale_color_manual(values=colval),                     guides(colour = guide_legend(reverse=TRUE))),        lab.cex=0.7 )  plot1GS(expr=expr_2grp, TimePoint=design$TimePoint,         Subject_ID=design$Patient_ID, gmt=gmt_sim,        geneset.name=\"Gene set 3\",        indiv=\"genes\",        group.var = design$group.var,        time_unit=\"H\",        gg.add=list(scale_color_manual(values=colval),                     guides(colour = guide_legend(reverse=TRUE))),        lab.cex=0.7 )  }"},{"path":"http://sistm.github.io/TcGSA/reference/plotFit.GS.html","id":null,"dir":"Reference","previous_headings":"","what":"Plotting function for exploring the fitness of the mixed modeling used in TcGSA — plotFit.GS","title":"Plotting function for exploring the fitness of the mixed modeling used in TcGSA — plotFit.GS","text":"function plots graphs informing fit mixed modeling gene expression performed TcGSA, 1 several gene sets.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotFit.GS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plotting function for exploring the fitness of the mixed modeling used in TcGSA — plotFit.GS","text":"","code":"plotFit.GS(   x,   expr,   design,   subject_name = \"Patient_ID\",   time_name = \"TimePoint\",   colnames_ID,   plot_type = c(\"Fit\", \"Residuals Obs\", \"Residuals Est\", \"Histogram Obs\"),   GeneSetsList,   color = c(\"genes\", \"time\", \"subjects\"),   marginal_hist = TRUE,   gg.add = list(theme()) )"},{"path":"http://sistm.github.io/TcGSA/reference/plotFit.GS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plotting function for exploring the fitness of the mixed modeling used in TcGSA — plotFit.GS","text":"x tcgsa object clustTrend, ClusteredTrends object print.ClusteredTrends plot.ClusteredTrends. expr matrix dataframe gene expression.  dimension \\(n\\)x\\(p\\), \\(p\\) samples column \\(n\\) genes row. design matrix dataframe containing experimental variables used model, namely subject_name, time_name, covariates_fixed  time_covariates applicable.  dimension \\(p\\)x\\(m\\)  row order columns expr. subject_name name factor variable design contains information  repetition units used mixed model, patient identifiers instance.   Default 'Patient_ID'.  See Details. time_name name numeric variable design contains  information time replicates (time points gene  expression measured).  Default 'TimePoint'.  See Details. colnames_ID name variable design contains column names expr expression data matrix.  See Details. plot_type character string indicating type plot drawn.  options  'Fit', 'Residuals Obs', 'Residuals Est' 'Histogram Obs'. GeneSetsList character string containing names gene set whose fit checked.  several gene sets checked, can character list vector  names gene sets. color character string indicating color scale used. One 3 :  'genes', 'time', 'subjects', otherwise, coloring used. marginal_hist logical flag indicating whether marginal histograms drawn.  used 'Fit' plot type. Default 'TRUE' gg.add list instructions add ggplot2 instructions. See +.gg.  Default list(theme()), adds nothing plot.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotFit.GS.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Plotting function for exploring the fitness of the mixed modeling used in TcGSA — plotFit.GS","text":"Hejblum BP, Skinner J, Thiebaut R, (2015)  Time-Course Gene Set Analysis Longitudinal Gene Expression Data.  PLOS Comput. Biol. 11(6):e1004310. doi: 10.1371/journal.pcbi.1004310","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/plotFit.GS.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plotting function for exploring the fitness of the mixed modeling used in TcGSA — plotFit.GS","text":"Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotFit.GS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plotting function for exploring the fitness of the mixed modeling used in TcGSA — plotFit.GS","text":"","code":"if(interactive()){  data(data_simu_TcGSA)  tcgsa_sim_1grp <- TcGSA.LR(expr=expr_1grp, gmt=gmt_sim, design=design,                            subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=FALSE) plotFit.GS(x=tcgsa_sim_1grp, expr=expr_1grp, design=design,          subject_name=\"Patient_ID\", time_name=\"TimePoint\",          colnames_ID=\"Sample_name\",           plot_type=\"Residuals Obs\",           GeneSetsList=c(\"Gene set 1\", \"Gene set 2\", \"Gene set 3\",                         \"Gene set 4\", \"Gene set 5\"),          color=\"genes\", gg.add=list(guides(color=FALSE)) )  plotFit.GS(x=tcgsa_sim_1grp, expr=expr_1grp, design=design,           subject_name=\"Patient_ID\", time_name=\"TimePoint\",           colnames_ID=\"Sample_name\",            plot_type=\"Histogram Obs\",            GeneSetsList=c(\"Gene set 1\", \"Gene set 5\"),           color=\"genes\", gg.add=list(guides(fill=FALSE))           )            plotFit.GS(x=tcgsa_sim_1grp, expr=expr_1grp, design=design,           subject_name=\"Patient_ID\", time_name=\"TimePoint\",           colnames_ID=\"Sample_name\",            plot_type=\"Histogram Obs\",            GeneSetsList=c(\"Gene set 1\", \"Gene set 2\", \"Gene set 3\",                     \"Gene set 4\", \"Gene set 5\"),           color=\"genes\") }"},{"path":"http://sistm.github.io/TcGSA/reference/plotMultipleGS.html","id":null,"dir":"Reference","previous_headings":"","what":"Plotting Multiple Gene Sets in a single plot — plotMultipleGS","title":"Plotting Multiple Gene Sets in a single plot — plotMultipleGS","text":"function can plot different representations gene expression  list gene sets.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotMultipleGS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plotting Multiple Gene Sets in a single plot — plotMultipleGS","text":"","code":"plotMultipleGS(   genesets_list,   ncolumns = 1,   labels = NULL,   expr,   gmt,   Subject_ID,   TimePoint,   baseline = NULL,   group.var = NULL,   Group_ID_paired = NULL,   ref = NULL,   group_of_interest = NULL,   FUNcluster = NULL,   clustering_metric = \"euclidian\",   clustering_method = \"ward\",   B = 500,   max_trends = 4,   aggreg.fun = \"median\",   na.rm.aggreg = TRUE,   trend.fun = \"median\",   methodOptiClust = \"firstSEmax\",   indiv = \"genes\",   verbose = TRUE,   clustering = TRUE,   showTrend = TRUE,   smooth = TRUE,   time_unit = \"\",   y.lab = NULL,   desc = TRUE,   lab.cex = 1,   axis.cex = 1,   main.cex = 1,   y.lab.angle = 90,   x.axis.angle = 45,   margins = 1,   line.size = 1,   y.lim = NULL,   x.lim = NULL,   gg.add = list(),   show_plot = TRUE )"},{"path":"http://sistm.github.io/TcGSA/reference/plotMultipleGS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plotting Multiple Gene Sets in a single plot — plotMultipleGS","text":"genesets_list list character strings giving names  gene sets plotted appear gmt. ncolumns number columns used display multiple plots.  Default 1. labels List labels added plots.  can also set labels=\"AUTO\" auto-generate upper-case labels (, B, ...)  labels=\"auto\" auto-generate lower-case labels. Default NULL expr either matrix dataframe gene expression upon dynamics calculated, list gene sets estimation gene expression.  case matrix dataframe, dimension \\(n\\) x \\(p\\), \\(p\\) sample column \\(n\\) genes row. case list, length correspond number gene sets scrutiny element 3 dimension array estimated gene expression, list returned 'Estimations' element TcGSA.LR.  See details. gmt gmt object containing gene sets definition.  See GSA.read.gmt definition www.software.broadinstitute.org. Subject_ID factor length \\(p\\) order columns expr (dataframe) contains patient identifier sample. TimePoint numeric vector factor length \\(p\\) order Subject_ID columns expr (dataframe), contains time points gene expression measured. baseline character string value TimePoint can used baseline.  Default NULL, case time point used baseline value gene expression.  NULL comparing two treatment groups. group.var case several treatment groups, factor length \\(p\\) order Timepoint, Subject_ID columns expr.  indicates treatment group sample belongs .  Default NULL, means one treatment group. Group_ID_paired character vector length \\(p\\) order Timepoint, Subject_ID, group.var columns expr.  argument must NULL case paired analysis, must NULL otherwise.  Default NULL. ref group used reference case several treatment groups.  Default NULL, means reference first group alphabetical order labels group.var.  See Details. group_of_interest group interest, dynamics computed case several treatment groups.  Default NULL, means group interest second group alphabetical order labels group.var. FUNcluster function accepts first argument matrix x second argument number clusters desired k, returns list component named 'cluster' vector length n = nrow(x) integers 1:k, determining clustering grouping n observations.  Default NULL, case hierarchical clustering performed via function agnes, using metric clustering_metric method clustering_method.  See 'FUNcluster' clusGap Details. clustering_metric character string specifying metric used calculating dissimilarities observations hierarchical clustering FUNcluster NULL.  currently available options \"euclidean\" \"manhattan\".  Default \"euclidean\".  See agnes.  Also, \"sts\" option  available TcGSA.  implements 'Short Time Series' distance  [Moller-Levet et al., Fuzzy Clustering short time series unevenly distributed  sampling points, Advances Intelligent Data Analysis V:330-340 Springer, 2003] designed specifically clustering time series. clustering_method character string defining agglomerative method used hierarchical clustering FUNcluster NULL.  six methods implemented \"average\" ([unweighted pair-]group average method, UPGMA), \"single\" (single linkage), \"complete\" (complete linkage), \"ward\" (Ward's method), \"weighted\" (weighted average linkage).  Default \"ward\".  See agnes. B integer specifying number Monte Carlo (\"bootstrap\") samples used compute gap statistics.  Default 500.  See clusGap. max_trends integer specifying maximum number different clusters tested.  Default 4. aggreg.fun character string \"median\" \"mean\" name defined statistics function returns single numeric value.  specifies function used aggregate observations clustering. Default \"median\". na.rm.aggreg logical flag indicating whether NA remove prevent  propagation aggreg.fun. Can useful set TRUE  unbalanced design generate structural NAs  $Estimations. Default TRUE. trend.fun character string \"mean\" name function returns single numeric value.  specifies function used calculate trends identified clustered.  Default \"mean\". methodOptiClust character string indicating \"optimal\" number clusters computed gap statistics standard deviations. Possible values \"globalmax\", \"firstmax\", \"Tibs2001SEmax\", \"firstSEmax\" \"globalSEmax\". Default \"firstSEmax\".  See 'method' clusGap, Details Tibshirani et al., 2001 References. indiv character string indicating unit observations aggregated (aggreg.fun) clustering.  Possible values \"genes\" \"patients\".  Default \"genes\". See Details. verbose logical flag enabling verbose messages track computing status function.  Default TRUE. clustering logical flag.  FALSE, clustering representation; TRUE, lines colored according cluster belong .  Default TRUE.  See Details. showTrend logical flag.  TRUE, black line added cluster, representing corresponding trend.fun.  Default TRUE. smooth logical flag.  TRUE showTrend also TRUE, representation cluster trend.fun smoothed using cubic polynomials (see geom_smooth. Default TRUE.  moment, must accept parameter \"na.rm\" (automatically set TRUE).  might change future versions time_unit time unit displayed (\"Y\", \"M\", \"W\", \"D\", \"H\", etc) next values TimePoint x-axis.  Default \"\", case time  scale x-axis proportional time values. y.lab character specifying annotation y axis.  NULL, annotation automatically generated, \"\", annotation appears.  Default NULL. desc logical flag. TRUE, line added title plot description gene set plotted (gmt file). Default TRUE. lab.cex numerical value giving amount lab labels text magnified relative default 1. axis.cex numerical value giving amount axis annotation text magnified relative default 1. main.cex numerical value giving amount title text magnified relative default 1. y.lab.angle numerical value ([0, 360]) giving orientation y-label text turned (anti-clockwise).  Default 90. See element_text. x.axis.angle numerical value ([0, 360]) giving orientation x-axis annotation text turned (anti-clockwise).  Default 45. margins numerical value giving amount margins reduced increased relative default 1. line.size numerical value giving amount line sizes reduced increased relative default 1. y.lim numeric vector length 2 giving range y-axis. See plot.default. x.lim numeric, create continuous scale, factor character, create discrete scale.  Observations range dropped.  See xlim. gg.add list instructions add ggplot2 instructions. See +.gg.  Default list(theme()), adds nothing plot. show_plot logical flag. FALSE, plot drawn. Default TRUE.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotMultipleGS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plotting Multiple Gene Sets in a single plot — plotMultipleGS","text":"list 2 elements: classif: data.frame  2 following variables: ProbeID    contains IDs probes plotted gene set, Cluster containing $   cluster probe belongs . clustering FALSE, Cluster NA probes. p: ggplot object containing plot","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotMultipleGS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plotting Multiple Gene Sets in a single plot — plotMultipleGS","text":"expr matrix dataframe, \"original\" data plotted.  hand, expr list returned 'Estimations' element TcGSA.LR, \"estimations\" made TcGSA.LR function plotted. indiv 'genes', line plot median gene expression patients. hand, indiv 'patients', line plot median patient genes expression gene set. function uses Gap statistics determine optimal number clusters plotted gene set.  See clusGap.","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/plotMultipleGS.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plotting Multiple Gene Sets in a single plot — plotMultipleGS","text":"Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.1GS.html","id":null,"dir":"Reference","previous_headings":"","what":"Plotting a Specific Gene Set Stratifying on Patients — plotPat.1GS","title":"Plotting a Specific Gene Set Stratifying on Patients — plotPat.1GS","text":"function can plot different representations gene expression specific gene set, stratified subjects.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.1GS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plotting a Specific Gene Set Stratifying on Patients — plotPat.1GS","text":"","code":"plotPat.1GS(   expr,   gmt,   Subject_ID,   TimePoint,   geneset.name,   baseline = NULL,   group.var = NULL,   Group_ID_paired = NULL,   ref = NULL,   group_of_interest = NULL,   FUNcluster = NULL,   clustering_metric = \"euclidian\",   clustering_method = \"ward\",   B = 500,   max_trends = 4,   aggreg.fun = \"median\",   na.rm.aggreg = TRUE,   trend.fun = \"median\",   methodOptiClust = \"firstSEmax\",   verbose = TRUE,   clustering = TRUE,   time_unit = \"\",   title = NULL,   y.lab = NULL,   desc = TRUE,   lab.cex = 1,   axis.cex = 1,   main.cex = 1,   y.lab.angle = 90,   x.axis.angle = 45,   y.lim = NULL,   x.lim = NULL,   gg.add = list(theme()) )"},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.1GS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plotting a Specific Gene Set Stratifying on Patients — plotPat.1GS","text":"expr either matrix dataframe gene expression upon dynamics calculated, list gene sets estimation gene expression.  case matrix dataframe, dimension \\(n\\) x \\(p\\), \\(p\\) sample column \\(n\\) genes row. case list, length correspond number gene sets scrutiny element 3 dimension array estimated gene expression, list returned 'Estimations' element TcGSA.LR.  See details. gmt gmt object containing gene sets definition.  See GSA.read.gmt definition www.software.broadinstitute.org. Subject_ID factor length \\(p\\) order columns expr (dataframe) contains patient identifier sample. TimePoint numeric vector factor length \\(p\\) order TimePoint columns expr (dataframe), contains time points gene expression measured. geneset.name character string containing name gene set plotted, must appear \"geneset.names\" element gmt. baseline character string value TimePoint can used baseline.  Default NULL, case time point used baseline value gene expression.  NULL comparing two treatment groups. group.var case several treatment groups, factor length \\(p\\) order Timepoint, Subject_ID columns expr.  indicates treatment group sample belongs .  Default NULL, means one treatment group.  See Details. Group_ID_paired character vector length \\(p\\) order Timepoint, Subject_ID, group.var columns expr.  argument must NULL case paired analysis, must NULL otherwise.  Default NULL. ref group used reference case several treatment groups.  Default NULL, means reference first group alphabetical order labels group.var.  See Details. group_of_interest group interest, dynamics computed case several treatment groups.  Default NULL, means group interest second group alphabetical order labels group.var. FUNcluster function accepts first argument matrix x second argument number clusters desired k, returns list component named 'cluster' vector length n = nrow(x) integers 1:k, determining clustering grouping n observations.  Default NULL, case hierarchical clustering performed via function agnes, using metric clustering_metric method clustering_method.  See 'FUNcluster' clusGap Details. clustering_metric character string specifying metric used calculating dissimilarities observations hierarchical clustering FUNcluster NULL.  currently available options \"euclidean\" \"manhattan\".  Default \"euclidean\".  See agnes.  Also, \"sts\" option  available TcGSA.  implements 'Short Time Series' distance  [Moller-Levet et al., Fuzzy Clustering short time series unevenly distributed  sampling points, Advances Intelligent Data Analysis V:330-340 Springer, 2003] designed specifically clustering time series. clustering_method character string defining agglomerative method used hierarchical clustering FUNcluster NULL.  six methods implemented \"average\" ([unweighted pair-]group average method, UPGMA), \"single\" (single linkage), \"complete\" (complete linkage), \"ward\" (Ward's method), \"weighted\" (weighted average linkage).  Default \"ward\".  See agnes. B integer specifying number Monte Carlo (\"bootstrap\") samples used compute gap statistics.  Default 500.  See clusGap. max_trends integer specifying maximum number different clusters tested.  Default 4. aggreg.fun character string \"mean\", \"median\" name defined statistics function returns single numeric value.  specifies function used aggregate observations clustering.  Default median. na.rm.aggreg logical flag indicating whether NA remove prevent  propagation aggreg.fun. Can useful set TRUE  unbalanced design generate structural NAs  $Estimations. Default TRUE. trend.fun character string \"mean\", \"median\" name function returns single numeric value.  specifies function used calculate trends identified clustered.  Default median. methodOptiClust character string indicating \"optimal\" number clusters computed gap statistics standard deviations. Possible values \"globalmax\", \"firstmax\", \"Tibs2001SEmax\", \"firstSEmax\" \"globalSEmax\". Default \"firstSEmax\".  See 'method' clusGap, Details Tibshirani et al., 2001 References. verbose logical flag enabling verbose messages track computing status function.  Default TRUE. clustering logical flag.  FALSE, clustering representation; TRUE, lines colored according cluster belong .  Default TRUE.  See Details. time_unit time unit displayed (\"Y\", \"M\", \"W\", \"D\", \"H\", etc) next values TimePoint x-axis.  Default \"\". title character specifying title plot.  NULL, title automatically generated, \"\", title appears.  Default NULL. y.lab character specifying annotation y axis.  NULL, annotation automatically generated, \"\", annotation appears.  Default NULL. desc logical flag. TRUE, line added title plot description gene set plotted (gmt file). Default TRUE. lab.cex numerical value giving amount lab labels text magnified relative default 1. axis.cex numerical value giving amount axis annotation text magnified relative default 1. main.cex numerical value giving amount title text magnified relative default 1. y.lab.angle numerical value ([0, 360]) giving orientation y-label text turned (anti-clockwise).  Default 90. See element_text. x.axis.angle numerical value ([0, 360]) giving orientation x-axis annotation text turned (anti-clockwise).  Default 45. y.lim numeric vector length 2 giving range y-axis. See plot.default. x.lim numeric, create continuous scale, factor character, create discrete scale.  Observations range dropped.  See xlim. gg.add list instructions add ggplot2 instructions. See +.gg.  Default list(theme()), adds nothing plot.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.1GS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plotting a Specific Gene Set Stratifying on Patients — plotPat.1GS","text":"dataframe 2 following variables: ProbeID contains IDs probes plotted gene set. Cluster cluster probe belongs . clustering FALSE, Cluster NA probes.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.1GS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plotting a Specific Gene Set Stratifying on Patients — plotPat.1GS","text":"expr matrix dataframe, \"original\" data plotted.  hand, expr list returned 'Estimations' element TcGSA.LR, \"estimations\" made TcGSA.LR function plotted. indiv 'genes', line plot median gene expression patients. hand, indiv 'patients', line plot median patient genes expression gene set. function uses Gap statistics determine optimal number clusters plotted gene set.  See clusGap.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.1GS.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Plotting a Specific Gene Set Stratifying on Patients — plotPat.1GS","text":"Tibshirani, R., Walther, G. Hastie, T., 2001, Estimating number data clusters via Gap statistic, Journal Royal Statistical Society, Series B (Statistical Methodology), 63, 2: 411--423.","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.1GS.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plotting a Specific Gene Set Stratifying on Patients — plotPat.1GS","text":"Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.1GS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plotting a Specific Gene Set Stratifying on Patients — plotPat.1GS","text":"","code":"if(interactive()){ data(data_simu_TcGSA) tcgsa_sim_1grp <- TcGSA.LR(expr=expr_1grp, gmt=gmt_sim, design=design,                            subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=FALSE)  plotPat.1GS(expr=expr_1grp, TimePoint=design$TimePoint,         Subject_ID=design$Patient_ID, gmt=gmt_sim,        geneset.name=\"Gene set 4\",        clustering=FALSE,        time_unit=\"H\",        lab.cex=0.7)  plotPat.1GS(expr=expr_1grp, TimePoint=design$TimePoint,         Subject_ID=design$Patient_ID, gmt=gmt_sim,        geneset.name=\"Gene set 4\",        clustering=FALSE, baseline=1,        time_unit=\"H\",        lab.cex=0.7)         colval <- c(hsv(0.56, 0.9, 1),            hsv(0, 0.27, 1),            hsv(0.52, 1, 0.5),            hsv(0, 0.55, 0.97),            hsv(0.66, 0.15, 1),            hsv(0, 0.81, 0.55),            hsv(0.7, 1, 0.7),            hsv(0.42, 0.33, 1) ) n <- length(colval);  y <- 1:n op <- par(mar=rep(1.5,4)) plot(y, axes = FALSE, frame.plot = TRUE,    xlab = \"\", ylab = \"\", pch = 21, cex = 8,    bg = colval, ylim=c(-1,n+1), xlim=c(-1,n+1),    main = \"Color scale\" ) par(op)  plotPat.1GS(expr=expr_1grp, TimePoint=design$TimePoint,         Subject_ID=design$Patient_ID, gmt=gmt_sim,        geneset.name=\"Gene set 5\",        time_unit=\"H\",        title=\"\",        gg.add=list(scale_color_manual(values=colval)),        lab.cex=0.7 )  plotPat.1GS(expr=tcgsa_sim_1grp$Estimations, TimePoint=design$TimePoint,         Subject_ID=design$Patient_ID, gmt=gmt_sim,        geneset.name=\"Gene set 3\",        time_unit=\"H\",        lab.cex=0.7 ) }"},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.TcGSA.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a Gene Set Trends Heatmap for each Patient. — plotPat.TcGSA","title":"Plot a Gene Set Trends Heatmap for each Patient. — plotPat.TcGSA","text":"function plots series gene sets dynamic trends heatmaps.  One heatmap drawn patient. IMPLEMENTED YET (TODO)","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.TcGSA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a Gene Set Trends Heatmap for each Patient. — plotPat.TcGSA","text":"","code":"plotPat.TcGSA(   x,   threshold = 0.05,   myproc = \"BY\",   nbsimu_pval = 1e+06,   expr,   Subject_ID,   TimePoint,   baseline = NULL,   only.signif = TRUE,   group.var = NULL,   Group_ID_paired = NULL,   ref = NULL,   group_of_interest = NULL,   FUNcluster = NULL,   clustering_metric = \"euclidian\",   clustering_method = \"ward\",   B = 500,   max_trends = 4,   aggreg.fun = \"median\",   na.rm.aggreg = TRUE,   methodOptiClust = \"firstSEmax\",   verbose = TRUE,   clust_trends = NULL,   N_clusters = NULL,   myclusters = NULL,   label.clusters = NULL,   prev_rowCL = NULL,   descript = TRUE,   plotAll = TRUE,   color.vec = c(\"darkred\", \"#D73027\", \"#FC8D59\", \"snow\", \"#91BFDB\", \"#4575B4\",     \"darkblue\"),   legend.breaks = NULL,   label.column = NULL,   time_unit = \"\",   cex.label.row = 1,   cex.label.column = 1,   margins = c(5, 25),   heatKey.size = 1,   dendrogram.size = 1,   heatmap.height = 1,   heatmap.width = 1,   cex.clusterKey = 1,   cex.main = 1,   horiz.clusterKey = TRUE,   main = NULL,   subtitle = NULL,   ... )"},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.TcGSA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a Gene Set Trends Heatmap for each Patient. — plotPat.TcGSA","text":"x tcgsa object. threshold threshold FDR FWER controlled. myproc vector character strings containing names multiple testing procedures adjusted p-values computed. vector include following: \"Bonferroni\", \"Holm\", \"Hochberg\", \"SidakSS\", \"SidakSD\", \"BH\", \"\", \"ABH\", \"TSBH\" \"none\".   \"none\" indicates adjustment multiple testing. See mt.rawp2adjp details.  Default \"\", Benjamini & Yekutieli (2001) step-FDR-controlling procedure (general dependency structures).  order control FWER(case analysis hypothesis confirmation exploration expression data), recommend use \"Holm\", Holm (1979) step-adjusted p-values strong control FWER. nbsimu_pval number observations null distribution generated order compute p-values. Default 1e+06. expr either matrix dataframe gene expression upon dynamics calculated, list gene sets estimation gene expression.  case matrix dataframe, dimension \\(n\\) x \\(p\\), \\(p\\) sample column \\(n\\) genes row. case list, length correspond number gene sets scrutiny element 3 dimension array estimated gene expression, list returned 'Estimations' element TcGSA.LR.  See Details. Subject_ID factor length \\(p\\) order columns expr (dataframe) contains patient identifier sample. TimePoint numeric vector factor length \\(p\\) order Subject_ID columns expr (dataframe), contains time points gene expression measured. baseline character string value TimePoint used baseline. .signif logical flag plotting significant gene sets. FALSE, gene sets gmt object contained x plotted.  Default TRUE. group.var case several treatment groups, factor length \\(p\\) order Timepoint, Subject_ID, sample_name columns expr.  indicates treatment group sample belongs .  Default NULL, means one treatment group.  See Details. Group_ID_paired character vector length \\(p\\) order Timepoint, Subject_ID, sample_name, group.var columns expr.  argument must NULL case paired analysis, must NULL otherwise.  Default NULL. ref group used reference case several treatment groups.  Default NULL, means reference first group alphabetical order labels group.var.  See Details. group_of_interest group interest, dynamics computed case several treatment groups.  Default NULL, means group interest second group alphabetical order labels group.var. FUNcluster clustering function used agglomerate genes trends.  Default NULL, hierarchical clustering performed via function agnes, using metric clustering_metric method clustering_method.  See clusGap clustering_metric character string specifying metric used calculating dissimilarities observations hierarchical clustering FUNcluster NULL.  currently available options \"euclidean\" \"manhattan\".  Default \"euclidean\".  See agnes.  Also, \"sts\" option  available TcGSA.  implements 'Short Time Series' distance  [Moller-Levet et al., Fuzzy Clustering short time series unevenly distributed  sampling points, Advances Intelligent Data Analysis V:330-340 Springer, 2003] designed specifically clustering time series. clustering_method character string defining agglomerative method used hierarchical clustering FUNcluster NULL.  six methods implemented \"average\" ([unweighted pair-]group average method, UPGMA), \"single\" (single linkage), \"complete\" (complete linkage), \"ward\" (Ward's method), \"weighted\" (weighted average linkage).  Default \"ward\".  See agnes. B integer specifying number Monte Carlo (\"bootstrap\") samples used compute gap statistics.  Default 500.  See clusGap. max_trends integer specifying maximum number different clusters tested.  Default 4. aggreg.fun character string \"mean\", \"median\" name statistics function defined returns single numeric value.  specifies function used aggregate observations clustering.  Default median.  Default \"median\". na.rm.aggreg logical flag indicating whether NA remove prevent  propagation aggreg.fun. Can useful set TRUE  unbalanced design generate structural NAs  $Estimations. Default TRUE. methodOptiClust character string indicating \"optimal\"\" number clusters computed gap statistics standard deviations. Possible values \"globalmax\", \"firstmax\", \"Tibs2001SEmax\", \"firstSEmax\" \"globalSEmax\". Default \"firstSEmax\".  See 'method' clusGap, Details Tibshirani et al., 2001 References. verbose logical flag enabling verbose messages track computing status function.  Default TRUE. clust_trends object class ClusteredTrends containing already computed trends plotted gene sets.  Default NULL. N_clusters integer number clusters dynamics regrouped. cutoff clustering tree automatically calculated accordingly.  Default NULL, case dendrogram cut clusters identified. myclusters character vector colors predefined clusters represented gene sets, many levels value N_clusters. Default NULL, case clusters automatically identified colored via cutree function N_clusters argument . label.clusters N_clusters NULL, character vector length N_clusterss.  Default NULL, case N_clusters NULL, clusters simply labeled numbers. prev_rowCL hclust object, one return present plotting function (see Value) instance.  NULL, clustering calculated present plotting function tree used represent gene sets dynamics.  Default NULL. descript logical flag indicating description gene sets appear name right side plot TRUE. Default TRUE.  See Details. plotAll logical flag indicating whether first heatmap median patients plotted, .  Default TRUE. color.vec character strings vector used define color palette used plot.  Default c(\"#D73027\", \"#FC8D59\",\"lightyellow\", \"#91BFDB\", \"#4575B4\"). legend.breaks numeric vector indicating splitting points coloring.  Default NULL, case break points spaced equally symmetrically 0. label.column vector character strings labels displayed columns (.e. time points).  Default NULL. time_unit time unit displayed (\"Y\", \"M\", \"W\", \"D\", \"H\", etc) next values TimePoint columns labels label.column NULL.  Default \"\". cex.label.row numerical value giving amount row labels text magnified relative default 1. cex.label.column numerical value giving amount column labels text magnified relative default 1. margins numeric vector length 2 containing margins (see par(mar= *)) column row names, respectively.  Default c(15, 100).  See Details. heatKey.size size color key heatmap fill.  Default 1. dendrogram.size horizontal size dendrogram.  Default 1 heatmap.height height heatmap.  Default 1 heatmap.width width heatmap.  Default 1 cex.clusterKey numerical value giving amount clusters legend text magnified relative default 1, N_clusters NULL. cex.main numerical value giving amount title text magnified relative default 1. horiz.clusterKey logical flag; TRUE, set legend clusters horizontally rather vertically.  used N_clusters argument NULL.  Default TRUE. main character string optional title.  Default NULL. subtitle character string optional subtitle.  Default NULL. ... parameters passed plotting functions.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.TcGSA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot a Gene Set Trends Heatmap for each Patient. — plotPat.TcGSA","text":"object class hclust describes tree produced clustering process.  object list components: merge \\(n-1\\) \\(2\\) matrix.  Row \\(\\) merge describes merging clusters step clustering. element \\(j\\) row negative, observation -\\(j\\) merged stage.  \\(j\\) positive merge cluster formed (earlier) stage \\(j\\) algorithm.  Thus negative entries merge indicate agglomerations singletons, positive entries indicate agglomerations non-singletons. height set \\(n-1\\) real values (non-decreasing ultrametric trees).  clustering height: , value criterion associated Ward clustering method. order vector giving permutation original observations suitable plotting, sense cluster plot using ordering matrix merge crossings branches. labels gene sets name. call call produced result clustering: hclust(d = dist(map2heat, method = \"euclidean\"), method = \"ward.D2\") method \"ward.D2\", clustering method used clustering gene set trends. dist.method \"euclidean\", distance used clustering gene set trends. legend.breaks numeric vector giving splitting points used coloring heatmap.  plot FALSE, NULL. myclusters character vector colors clusters represented gene sets, many levels value N_clusters. clusters represented, NULL. ddr dendrogram object reordering used heatmap.  See heatmap.2 function package  gplots. clustersExport data frame 2 variables containing two following variables : GeneSet: gene sets clustered. Cluster: cluster belong . data frame order variable Cluster.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.TcGSA.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot a Gene Set Trends Heatmap for each Patient. — plotPat.TcGSA","text":"heatmap, line corresponds gene set, column time point. First heatmap computed patients (see plot.TcGSA clustTrend) define clustering. , clustering coloring thus defined patients consistently used separate heatmaps plotted patient. expr matrix dataframe, \"original\" data plotted.  hand, expr list returned 'Estimations' element TcGSA.LR, \"estimations\" made TcGSA.LR function plotted. descript FALSE, second element margins can reduced (instance use margins = c(5, 10)), much need space order display gene set names, without description. median shown heatmap uses respectively standardized (reduced centered) expression genes patients.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.TcGSA.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Plot a Gene Set Trends Heatmap for each Patient. — plotPat.TcGSA","text":"Hejblum BP, Skinner J, Thiebaut R, (2015)  Time-Course Gene Set Analysis Longitudinal Gene Expression Data.  PLOS Comput. Biol. 11(6):e1004310. doi: 10.1371/journal.pcbi.1004310","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.TcGSA.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot a Gene Set Trends Heatmap for each Patient. — plotPat.TcGSA","text":"Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotPat.TcGSA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot a Gene Set Trends Heatmap for each Patient. — plotPat.TcGSA","text":"","code":"if(interactive()){ data(data_simu_TcGSA)  tcgsa_sim_1grp <- TcGSA.LR(expr=expr_1grp, gmt=gmt_sim, design=design,                            subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=FALSE)  plotPat.TcGSA(x=tcgsa_sim_1grp, expr=expr_1grp,      Subject_ID=design$Patient_ID, TimePoint=design$TimePoint,     B=100,     time_unit=\"H\"     )  plotPat.TcGSA(x=tcgsa_sim_1grp, expr=tcgsa_sim_1grp$Estimations,      Subject_ID=design$Patient_ID, TimePoint=design$TimePoint,     baseline=1,      B=100,     time_unit=\"H\"     ) }"},{"path":"http://sistm.github.io/TcGSA/reference/plotSelect.GS.html","id":null,"dir":"Reference","previous_headings":"","what":"Plotting (several) Selected Gene Set(s) in some Subjects — plotSelect.GS","title":"Plotting (several) Selected Gene Set(s) in some Subjects — plotSelect.GS","text":"function can plot different representations gene expression selected gene sets, among subset selected subjects.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotSelect.GS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plotting (several) Selected Gene Set(s) in some Subjects — plotSelect.GS","text":"","code":"plotSelect.GS(   expr,   gmt,   Subject_ID,   TimePoint,   geneset.names.select,   Subject_ID.select,   display = \"one subject per page\",   baseline = NULL,   group.var = NULL,   Group_ID_paired = NULL,   ref = NULL,   group_of_interest = NULL,   FUNcluster = NULL,   clustering_metric = \"euclidian\",   clustering_method = \"ward\",   B = 500,   max_trends = 4,   aggreg.fun = \"median\",   na.rm.aggreg = TRUE,   trend.fun = \"median\",   methodOptiClust = \"firstSEmax\",   verbose = TRUE,   clustering = TRUE,   time_unit = \"\",   title = NULL,   y.lab = NULL,   desc = TRUE,   lab.cex = 1,   axis.cex = 1,   main.cex = 1,   y.lab.angle = 90,   x.axis.angle = 45,   y.lim = NULL,   x.lim = NULL,   gg.add = list(theme()) )"},{"path":"http://sistm.github.io/TcGSA/reference/plotSelect.GS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plotting (several) Selected Gene Set(s) in some Subjects — plotSelect.GS","text":"expr either matrix dataframe gene expression upon dynamics calculated, list gene sets estimation gene expression.  case matrix dataframe, dimension \\(n\\) x \\(p\\), \\(p\\) sample column \\(n\\) genes row. case list, length correspond number gene sets scrutiny element 3 dimension array estimated gene expression, list returned 'Estimations' element TcGSA.LR.  See Details. gmt gmt object containing gene sets definition.  See GSA.read.gmt definition www.software.broadinstitute.org. Subject_ID factor length \\(p\\) order columns expr (dataframe) contains patient identifier sample. TimePoint numeric vector factor length \\(p\\) order TimePoint columns expr (dataframe), contains time points gene expression measured. geneset.names.select character vector containing names gene sets plotted, must appear \"geneset.names\" element gmt. Subject_ID.select character vector containing names subjects plotted, must appear Subject_ID vector. display display resulting graphs.  One following :  \"one GS per page\", \"one subject per page\", \"median selected patients\".   Default \"one subject per page\". baseline character string value TimePoint can used baseline.  Default NULL, case time point used baseline value gene expression.  NULL comparing two treatment groups. group.var case several treatment groups, factor length \\(p\\) order Timepoint, Subject_ID columns expr.  indicates treatment group sample belongs .  Default NULL, means one treatment group. Group_ID_paired character vector length \\(p\\) order Timepoint, Subject_ID, group.var columns expr.  argument must NULL case paired analysis, must NULL otherwise.  Default NULL. ref group used reference case several treatment groups.  Default NULL, means reference first group alphabetical order labels group.var.  See Details. group_of_interest group interest, dynamics computed case several treatment groups.  Default NULL, means group interest second group alphabetical order labels group.var. FUNcluster function accepts first argument matrix x second argument number clusters desired k, returns list component named 'cluster' vector length n = nrow(x) integers 1:k, determining clustering grouping n observations.  Default NULL, case hierarchical clustering performed via function agnes, using metric clustering_metric method clustering_method.  See 'FUNcluster' clusGap Details. clustering_metric character string specifying metric used calculating dissimilarities observations hierarchical clustering FUNcluster NULL.  currently available options \"euclidean\" \"manhattan\".  Default \"euclidean\".  See agnes.  Also, \"sts\" option  available TcGSA.  implements 'Short Time Series' distance  [Moller-Levet et al., Fuzzy Clustering short time series unevenly distributed  sampling points, Advances Intelligent Data Analysis V:330-340 Springer, 2003] designed specifically clustering time series. clustering_method character string defining agglomerative method used hierarchical clustering FUNcluster NULL.  six methods implemented \"average\" ([unweighted pair-]group average method, UPGMA), \"single\" (single linkage), \"complete\" (complete linkage), \"ward\" (Ward's method), \"weighted\" (weighted average linkage).  Default \"ward\".  See agnes. B integer specifying number Monte Carlo (\"bootstrap\") samples used compute gap statistics.  Default 500.  See clusGap. max_trends integer specifying maximum number different clusters tested.  Default 4. aggreg.fun character string \"mean\", \"median\" name defined statistics function returns single numeric value.  specifies function used aggregate observations clustering.  Default median. na.rm.aggreg logical flag indicating whether NA remove prevent  propagation aggreg.fun. Can useful set TRUE  unbalanced design generate structural NAs  $Estimations. Default TRUE. trend.fun character string \"mean\", \"median\" name function returns single numeric value.  specifies function used calculate trends identified clustered.  Default median. methodOptiClust character string indicating \"optimal\" number clusters computed gap statistics standard deviations. Possible values \"globalmax\", \"firstmax\", \"Tibs2001SEmax\", \"firstSEmax\" \"globalSEmax\". Default \"firstSEmax\".  See 'method' clusGap, Details Tibshirani et al., 2001 References. verbose logical flag enabling verbose messages track computing status function.  Default TRUE. clustering logical flag.  FALSE, clustering representation; TRUE, lines colored according cluster belong .  Default TRUE.  See Details. time_unit time unit displayed (\"Y\", \"M\", \"W\", \"D\", \"H\", etc) next values TimePoint x-axis.  Default \"\". title character specifying title plot.  NULL, title automatically generated, \"\", title appears.  Default NULL. y.lab character specifying annotation y axis.  NULL, annotation automatically generated, \"\", annotation appears.  Default NULL. desc logical flag. TRUE, line added title plot description gene set plotted (gmt file). Default TRUE. lab.cex numerical value giving amount lab labels text magnified relative default 1. axis.cex numerical value giving amount axis annotation text magnified relative default 1. main.cex numerical value giving amount title text magnified relative default 1. y.lab.angle numerical value ([0, 360]) giving orientation y-label text turned (anti-clockwise).  Default 90. See element_text. x.axis.angle numerical value ([0, 360]) giving orientation x-axis annotation text turned (anti-clockwise).  Default 45. y.lim numeric vector length 2 giving range y-axis. See plot.default. x.lim numeric, create continuous scale, factor character, create discrete scale.  Observations range dropped.  See xlim. gg.add list instructions add ggplot2 instructions.  See +.gg. Default list(theme()), adds nothing plot.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotSelect.GS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plotting (several) Selected Gene Set(s) in some Subjects — plotSelect.GS","text":"dataframe 2 following variables: ProbeID contains IDs probes plotted gene set. Cluster cluster probe belongs . clustering FALSE, Cluster NA probes.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotSelect.GS.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plotting (several) Selected Gene Set(s) in some Subjects — plotSelect.GS","text":"expr matrix dataframe, \"original\" data plotted.  hand, expr list returned 'Estimations' element TcGSA.LR, \"estimations\" made TcGSA.LR function plotted. indiv 'genes', line plot median gene expression patients. hand, indiv 'patients', line plot median patient genes expression gene set. function uses Gap statistics determine optimal number clusters plotted gene set.  See clusGap.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotSelect.GS.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Plotting (several) Selected Gene Set(s) in some Subjects — plotSelect.GS","text":"Tibshirani, R., Walther, G. Hastie, T., 2001, Estimating number data clusters via Gap statistic, Journal Royal Statistical Society, Series B (Statistical Methodology), 63, 2: 411--423.","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/plotSelect.GS.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plotting (several) Selected Gene Set(s) in some Subjects — plotSelect.GS","text":"Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/plotSelect.GS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plotting (several) Selected Gene Set(s) in some Subjects — plotSelect.GS","text":"","code":"if(interactive()){ data(data_simu_TcGSA) tcgsa_sim_1grp <- TcGSA.LR(expr=expr_1grp, gmt=gmt_sim, design=design,                            subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=TRUE) }  if(interactive()){ plotSelect.GS(expr=expr_1grp, TimePoint=design$TimePoint,         Subject_ID=design$Patient_ID, gmt=gmt_sim,        geneset.names.select=c(\"Gene set 4\", \"Gene set 5\"),        Subject_ID.select=c(\"P1\", \"P2\"),        display=\"one GS per page\",         time_unit=\"H\",        lab.cex=0.7 ) }  if(interactive()){ plotSelect.GS(expr=tcgsa_sim_1grp$Estimations, TimePoint=design$TimePoint,         Subject_ID=design$Patient_ID, gmt=gmt_sim,        geneset.names.select=c(\"Gene set 4\", \"Gene set 5\"),        Subject_ID.select=c(\"P1\", \"P2\"),        display=\"one subject per page\",         time_unit=\"H\",        lab.cex=0.7 ) }   if(interactive()){ tcgsa_sim_1grp <- TcGSA.LR(expr=expr_1grp, gmt=gmt_sim, design=design,                            subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=FALSE)                            plotSelect.GS(expr=tcgsa_sim_1grp$Estimations, TimePoint=design$TimePoint,         Subject_ID=design$Patient_ID, gmt=gmt_sim,        geneset.names.select=c(\"Gene set 4\", \"Gene set 5\"),        Subject_ID.select=c(\"P1\", \"P2\"),        display=\"one subject per page\",         time_unit=\"H\",        lab.cex=0.7 ) }"},{"path":"http://sistm.github.io/TcGSA/reference/pval_simu.html","id":null,"dir":"Reference","previous_headings":"","what":"Computing P-values with a Simulated Sample from the Null Distribution — pval_simu","title":"Computing P-values with a Simulated Sample from the Null Distribution — pval_simu","text":"function computes p-value statistic using simulated sample theoretical null distribution.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/pval_simu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Computing P-values with a Simulated Sample from the Null Distribution — pval_simu","text":"","code":"pval_simu(s, theo_dist)"},{"path":"http://sistm.github.io/TcGSA/reference/pval_simu.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Computing P-values with a Simulated Sample from the Null Distribution — pval_simu","text":"s observation whose p-value computed.  instance Likelihood Ratio. theo_dist sample distribution null hypothesis.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/pval_simu.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Computing P-values with a Simulated Sample from the Null Distribution — pval_simu","text":"p-value associated observation s.","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/pval_simu.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Computing P-values with a Simulated Sample from the Null Distribution — pval_simu","text":"Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/pval_simu.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Computing P-values with a Simulated Sample from the Null Distribution — pval_simu","text":"","code":"if(interactive()){ theo_dist <- rnorm(n=10000, mean=0, sd=1) TcGSA:::pval_simu(s=1.96, theo_dist) 1-pnorm(q=1.96, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE) }"},{"path":"http://sistm.github.io/TcGSA/reference/signifLRT.TcGSA.html","id":null,"dir":"Reference","previous_headings":"","what":"Identifying the Significant Gene Sets — signifLRT.TcGSA","title":"Identifying the Significant Gene Sets — signifLRT.TcGSA","text":"function identifies significant gene sets object class 'TcGSA'.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/signifLRT.TcGSA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identifying the Significant Gene Sets — signifLRT.TcGSA","text":"","code":"signifLRT.TcGSA(   tcgsa,   threshold = 0.05,   myproc = \"BY\",   nbsimu_pval = 1e+06,   write = F,   txtfilename = NULL,   directory = NULL,   exact = TRUE )"},{"path":"http://sistm.github.io/TcGSA/reference/signifLRT.TcGSA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identifying the Significant Gene Sets — signifLRT.TcGSA","text":"tcgsa tcgsa object. threshold threshold FDR FWER controlled. myproc vector character strings containing names multiple testing procedures adjusted p-values computed. vector include following: \"Bonferroni\", \"Holm\", \"Hochberg\", \"SidakSS\", \"SidakSD\", \"BH\", \"\", \"ABH\", \"TSBH\" \"none\".   \"none\" indicates adjustment multiple testing. See mt.rawp2adjp details.  Default \"\", Benjamini & Yekutieli (2001) step-FDR-controlling procedure (general dependency structures).  order control FWER(case analysis hypothesis confirmation exploration expression data), recommend use \"Holm\", Holm (1979) step-adjusted p-values strong control FWER. nbsimu_pval number observations null distribution generated order compute p-values.  Default 1e+06. write logical flag enabling export results table .txt file.  Default FALSE. txtfilename character string name .txt file results table written, write TRUE. Default NULL. directory write TRUE, character string directory .txt file results table written, write TRUE. Default NULL. exact logical flag indicating whether raw p-values computed  exact asymptotic mixture chi-square, simulated (longer better). Default TRUE preferred.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/signifLRT.TcGSA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identifying the Significant Gene Sets — signifLRT.TcGSA","text":"signifLRT.TcGSA returns list.  first element mixedLRTadjRes data frame \\(p\\) rows (one row significant gene set) 3 following variables: GeneSet significant gene set name gmt object. AdjPval adjusted p-value corresponding significant gene set. desc significant gene set description gmt object. second element multCorProc passes along multiple testing  procedure used (argument myproc). third element threshold passes along significance threshold used (argument threshold).","code":""},{"path":"http://sistm.github.io/TcGSA/reference/signifLRT.TcGSA.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Identifying the Significant Gene Sets — signifLRT.TcGSA","text":"Hejblum BP, Skinner J, Thiebaut R, (2015)  Time-Course Gene Set Analysis Longitudinal Gene Expression Data.  PLOS Comput. Biol. 11(6):e1004310. doi: 10.1371/journal.pcbi.1004310","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/signifLRT.TcGSA.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Identifying the Significant Gene Sets — signifLRT.TcGSA","text":"Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/signifLRT.TcGSA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identifying the Significant Gene Sets — signifLRT.TcGSA","text":"","code":"if(interactive()){ data(data_simu_TcGSA)  tcgsa_sim_1grp <- TcGSA.LR(expr=expr_1grp, gmt=gmt_sim, design=design,                            subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=FALSE)                            sgnifs <- signifLRT.TcGSA(tcgsa_sim_1grp, threshold = 0.05, myproc = \"BY\",                          nbsimu_pval = 1000, write=FALSE) sgnifs }"},{"path":"http://sistm.github.io/TcGSA/reference/summary.TcGSA.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarizing TcGSA — summary.TcGSA","title":"Summarizing TcGSA — summary.TcGSA","text":"summary method class 'TcGSA'","code":""},{"path":"http://sistm.github.io/TcGSA/reference/summary.TcGSA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarizing TcGSA — summary.TcGSA","text":"","code":"# S3 method for TcGSA summary(object, ...)  # S3 method for summary.TcGSA print(x, ...)"},{"path":"http://sistm.github.io/TcGSA/reference/summary.TcGSA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarizing TcGSA — summary.TcGSA","text":"object object class 'TcGSA'. ... arguments passed methods. x object class 'summary.TcGSA'.","code":""},{"path":"http://sistm.github.io/TcGSA/reference/summary.TcGSA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarizing TcGSA — summary.TcGSA","text":"function summary.TcGSA returns list following components (list elements): time_func chosen form time trend. separateSubjects logical flag indicating whether gene sets tested discriminating among patients, time trends time. ntg number treatment groups. ngs number tested gene sets. nsignif number significant gene sets 5% FDR (using default Benjamini & Yekutieli step-procedure).","code":""},{"path":[]},{"path":"http://sistm.github.io/TcGSA/reference/summary.TcGSA.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Summarizing TcGSA — summary.TcGSA","text":"Boris P. Hejblum","code":""},{"path":"http://sistm.github.io/TcGSA/reference/summary.TcGSA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarizing TcGSA — summary.TcGSA","text":"","code":"if(interactive()){ data(data_simu_TcGSA)  tcgsa_sim_1grp <- TcGSA.LR(expr=expr_1grp, gmt=gmt_sim, design=design,                            subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=FALSE) summary(tcgsa_sim_1grp)  tcgsa_sim_2grp <- TcGSA.LR(expr=expr_2grp, gmt=gmt_sim, design=design,                            subject_name=\"Patient_ID\", time_name=\"TimePoint\",                           time_func=\"linear\", crossedRandom=FALSE,                            group_name=\"group.var\") summary(tcgsa_sim_2grp) }"},{"path":"http://sistm.github.io/TcGSA/news/index.html","id":"tcgsa-01210","dir":"Changelog","previous_headings":"","what":"TcGSA 0.12.10","title":"TcGSA 0.12.10","text":"improved documentation","code":""},{"path":"http://sistm.github.io/TcGSA/news/index.html","id":"tcgsa-0127","dir":"Changelog","previous_headings":"","what":"TcGSA 0.12.7","title":"TcGSA 0.12.7","text":"CRAN release: 2020-01-23 better handling NA values removed gplots dependency (used documentation) gplots orphaned","code":""},{"path":"http://sistm.github.io/TcGSA/news/index.html","id":"tcgsa-0125","dir":"Changelog","previous_headings":"","what":"TcGSA 0.12.5","title":"TcGSA 0.12.5","text":"adding partial support group.var plot1GS()","code":""},{"path":"http://sistm.github.io/TcGSA/news/index.html","id":"tcgsa-0124","dir":"Changelog","previous_headings":"","what":"TcGSA 0.12.4","title":"TcGSA 0.12.4","text":"CRAN release: 2019-04-30 Prevent simultaneous use baseline group.var plotting functions Added na.rm support aggreg.fun() everywhere","code":""},{"path":"http://sistm.github.io/TcGSA/news/index.html","id":"tcgsa-0110","dir":"Changelog","previous_headings":"","what":"TcGSA 0.11.0","title":"TcGSA 0.11.0","text":"Added vignette p-values -longer simulated computed asymptotic chi^2 mixture","code":""},{"path":"http://sistm.github.io/TcGSA/news/index.html","id":"tcgsa-0107","dir":"Changelog","previous_headings":"","what":"TcGSA 0.10.7","title":"TcGSA 0.10.7","text":"Added plotMultipleGS() function","code":""},{"path":"http://sistm.github.io/TcGSA/news/index.html","id":"tcgsa-0106","dir":"Changelog","previous_headings":"","what":"TcGSA 0.10.6","title":"TcGSA 0.10.6","text":"Added NEWS.md file track changes package.","code":""},{"path":"http://sistm.github.io/TcGSA/news/index.html","id":"tcgsa-0105","dir":"Changelog","previous_headings":"","what":"TcGSA 0.10.5","title":"TcGSA 0.10.5","text":"CRAN release: 2017-05-03 Bug fix: plot.TcGSA better handles various genesets names","code":""}]
