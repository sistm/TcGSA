<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot a Gene Set Trends Heatmap. — plot.TcGSA • TcGSA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot a Gene Set Trends Heatmap. — plot.TcGSA"><meta name="description" content="This function plots a gene sets dynamic trends heatmap."><meta property="og:description" content="This function plots a gene sets dynamic trends heatmap."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TcGSA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.13</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/TcGSA_userguide.html">User guide to the `TcGSA` R package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sistm/TcGSA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot a Gene Set Trends Heatmap.</h1>
      <small class="dont-index">Source: <a href="https://github.com/sistm/TcGSA/blob/master/R/plot.TcGSA.R" class="external-link"><code>R/plot.TcGSA.R</code></a></small>
      <div class="d-none name"><code>plot.TcGSA.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function plots a gene sets dynamic trends heatmap.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'TcGSA'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  myproc <span class="op">=</span> <span class="st">"BY"</span>,</span>
<span>  nbsimu_pval <span class="op">=</span> <span class="fl">1e+06</span>,</span>
<span>  <span class="va">expr</span>,</span>
<span>  <span class="va">Subject_ID</span>,</span>
<span>  <span class="va">TimePoint</span>,</span>
<span>  baseline <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  only.signif <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  group.var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Group_ID_paired <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ref <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_of_interest <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ranking <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  FUNcluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clustering_metric <span class="op">=</span> <span class="st">"euclidian"</span>,</span>
<span>  clustering_method <span class="op">=</span> <span class="st">"ward"</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  max_trends <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  aggreg.fun <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>  na.rm.aggreg <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  methodOptiClust <span class="op">=</span> <span class="st">"firstSEmax"</span>,</span>
<span>  indiv <span class="op">=</span> <span class="st">"genes"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clust_trends <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  N_clusters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  myclusters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label.clusters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prev_rowCL <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  descript <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  color.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkred"</span>, <span class="st">"#D73027"</span>, <span class="st">"#FC8D59"</span>, <span class="st">"snow"</span>, <span class="st">"#91BFDB"</span>, <span class="st">"#4575B4"</span>,</span>
<span>    <span class="st">"darkblue"</span><span class="op">)</span>,</span>
<span>  legend.breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label.column <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  time_unit <span class="op">=</span> <span class="st">""</span>,</span>
<span>  cex.label.row <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cex.label.column <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  margins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">25</span><span class="op">)</span>,</span>
<span>  heatKey.size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  dendrogram.size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  heatmap.height <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  heatmap.width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cex.clusterKey <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cex.main <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  horiz.clusterKey <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an object of class'<code>TcGSA</code>'.</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>the threshold at which the FDR or the FWER should be
controlled.</p></dd>


<dt id="arg-myproc">myproc<a class="anchor" aria-label="anchor" href="#arg-myproc"></a></dt>
<dd><p>a vector of character strings containing the names of the
multiple testing procedures for which adjusted p-values are to be computed.
This vector should include any of the following: "<code>Bonferroni</code>",
"<code>Holm</code>", "<code>Hochberg</code>", "<code>SidakSS</code>", "<code>SidakSD</code>",
"<code>BH</code>", "<code>BY</code>", "<code>ABH</code>", "<code>TSBH</code>" or "<code>none</code>".
"<code>none</code>" indicates no adjustment for multiple testing. See
<code><a href="https://rdrr.io/pkg/multtest/man/mt.rawp2adjp.html" class="external-link">mt.rawp2adjp</a></code> for details.  Default is
"<code>BY</code>", the Benjamini &amp; Yekutieli (2001) step-up FDR-controlling
procedure (general dependency structures).  In order to control the FWER(in
case of an analysis that is more a hypothesis confirmation than an
exploration of the expression data), we recommend to use "<code>Holm</code>", the
Holm (1979) step-down adjusted p-values for strong control of the FWER.</p></dd>


<dt id="arg-nbsimu-pval">nbsimu_pval<a class="anchor" aria-label="anchor" href="#arg-nbsimu-pval"></a></dt>
<dd><p>the number of observations under the null distribution to
be generated in order to compute the p-values. Default is <code>1e+06</code>.</p></dd>


<dt id="arg-expr">expr<a class="anchor" aria-label="anchor" href="#arg-expr"></a></dt>
<dd><p>either a matrix or dataframe of gene expression upon which
dynamics are to be calculated, or a list of gene sets estimation of gene
expression.  In the case of a matrix or dataframe, its dimension are \(n\)
x \(p\), with the \(p\) sample in column and the \(n\) genes in row.
In the case of a list, its length should correspond to the number of gene
sets under scrutiny and each element should be an 3 dimension array of
estimated gene expression, such as for the list returned in the
<code>'Estimations'</code> element of <code><a href="TcGSA.LR.html">TcGSA.LR</a></code>.  See details.</p></dd>


<dt id="arg-subject-id">Subject_ID<a class="anchor" aria-label="anchor" href="#arg-subject-id"></a></dt>
<dd><p>a factor of length \(p\) that is in the same order as the
columns of <code>expr</code> (when it is a dataframe) and that contains the patient
identifier of each sample. Ignored if <code>expr</code> is a list of estimations.</p></dd>


<dt id="arg-timepoint">TimePoint<a class="anchor" aria-label="anchor" href="#arg-timepoint"></a></dt>
<dd><p>a numeric vector or a factor of length \(p\) that is in
the same order as <code>Subject_ID</code> and the columns of <code>expr</code> (when it
is a dataframe), and that contains the time points at which gene expression
was measured. Ignored if <code>expr</code> is a list of estimations.</p></dd>


<dt id="arg-baseline">baseline<a class="anchor" aria-label="anchor" href="#arg-baseline"></a></dt>
<dd><p>the value of <code>TimePoint</code> to be used as baseline. Default is <code>NULL</code>
in which case expression is centered and no baseline is used.</p></dd>


<dt id="arg-only-signif">only.signif<a class="anchor" aria-label="anchor" href="#arg-only-signif"></a></dt>
<dd><p>logical flag for plotting only the significant gene sets.
If <code>FALSE</code>, all the gene sets from the <b>gmt</b> object contained in
<code>x</code> are plotted.  Default is <code>TRUE</code>.</p></dd>


<dt id="arg-group-var">group.var<a class="anchor" aria-label="anchor" href="#arg-group-var"></a></dt>
<dd><p>in the case of several treatment` groups, this is a factor of
length \(p\) that is in the same order as <code>Timepoint</code>,
<code>Subject_ID</code>, <code>sample_name</code> and the columns of <code>expr</code>.  It
indicates to which treatment group each sample belongs to.  Default is
<code>NULL</code>, which means that there is only one treatment group.  See
Details.</p></dd>


<dt id="arg-group-id-paired">Group_ID_paired<a class="anchor" aria-label="anchor" href="#arg-group-id-paired"></a></dt>
<dd><p>a character vector of length \(p\) that is in the
same order as <code>Timepoint</code>, <code>Subject_ID</code>, <code>sample_name</code>,
<code>group.var</code> and the columns of <code>expr</code>.  This argument must not be
<code>NULL</code> in the case of a paired analysis, and must be <code>NULL</code>
otherwise.  Default is <code>NULL</code>.  See Details.</p></dd>


<dt id="arg-ref">ref<a class="anchor" aria-label="anchor" href="#arg-ref"></a></dt>
<dd><p>the group which is used as reference in the case of several
treatment groups.  Default is <code>NULL</code>, which means that reference is the
first group in alphabetical order of the labels of <code>group.var</code>.  See
Details.</p></dd>


<dt id="arg-group-of-interest">group_of_interest<a class="anchor" aria-label="anchor" href="#arg-group-of-interest"></a></dt>
<dd><p>the group of interest, for which dynamics are to be
computed in the case of several treatment groups.  Default is <code>NULL</code>,
which means that group of interest is the second group in alphabetical order
of the labels of <code>group.var</code>.  See Details.<!-- %% ~~Describe -->
<code>group_of_interest</code> here~~</p></dd>


<dt id="arg-ranking">ranking<a class="anchor" aria-label="anchor" href="#arg-ranking"></a></dt>
<dd><p>a logical flag. If <code>TRUE</code>, the gene set trends are not hierarchically classified, but
ordered by decreasing Likelihood ratios. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-funcluster">FUNcluster<a class="anchor" aria-label="anchor" href="#arg-funcluster"></a></dt>
<dd><p>the clustering function used to agglomerate genes in
trends.  Default is <code>NULL</code>, in which a hierarchical clustering is
performed via the function <code><a href="https://rdrr.io/pkg/cluster/man/agnes.html" class="external-link">agnes</a></code>, using the
metric <code>clustering_metric</code> and the method <code>clustering_method</code>.  See
<code><a href="https://rdrr.io/pkg/cluster/man/clusGap.html" class="external-link">clusGap</a></code></p></dd>


<dt id="arg-clustering-metric">clustering_metric<a class="anchor" aria-label="anchor" href="#arg-clustering-metric"></a></dt>
<dd><p>character string specifying the metric to be used
for calculating dissimilarities between observations in the hierarchical
clustering when <code>FUNcluster</code> is <code>NULL</code>.  The currently available
options are <code>"euclidean"</code> and <code>"manhattan"</code>.  Default is
<code>"euclidean"</code>.  See <code><a href="https://rdrr.io/pkg/cluster/man/agnes.html" class="external-link">agnes</a></code>.  Also, a <code>"sts"</code> option
is available in TcGSA.  It implements the 'Short Time Series' distance
[Moller-Levet et al., Fuzzy Clustering of short time series and unevenly distributed
sampling points, <em>Advances in Intelligent Data Analysis V</em>:330-340 Springer, 2003]
designed specifically for clustering time series.</p></dd>


<dt id="arg-clustering-method">clustering_method<a class="anchor" aria-label="anchor" href="#arg-clustering-method"></a></dt>
<dd><p>character string defining the agglomerative method
to be used in the hierarchical clustering when <code>FUNcluster</code> is
<code>NULL</code>.  The six methods implemented are <code>"average"</code> ([unweighted
pair-]group average method, UPGMA), <code>"single"</code> (single linkage),
<code>"complete"</code> (complete linkage), <code>"ward"</code> (Ward's method),
<code>"weighted"</code> (weighted average linkage).  Default is <code>"ward"</code>.  See
<code><a href="https://rdrr.io/pkg/cluster/man/agnes.html" class="external-link">agnes</a></code>.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>integer specifying the number of Monte Carlo ("bootstrap") samples
used to compute the gap statistics.  Default is <code>500</code>.  See
<code><a href="https://rdrr.io/pkg/cluster/man/clusGap.html" class="external-link">clusGap</a></code>.</p></dd>


<dt id="arg-max-trends">max_trends<a class="anchor" aria-label="anchor" href="#arg-max-trends"></a></dt>
<dd><p>integer specifying the maximum number of different clusters
to be tested.  Default is <code>4</code>.</p></dd>


<dt id="arg-aggreg-fun">aggreg.fun<a class="anchor" aria-label="anchor" href="#arg-aggreg-fun"></a></dt>
<dd><p>a character string such as <code>"mean"</code>, <code>"median"</code>
or the name of any other statistics function defined that returns a single
numeric value.  It specifies the function used to aggregate the observations
before the clustering.  Default is to <code>median</code>.  Default is
<code>"median"</code>.</p></dd>


<dt id="arg-na-rm-aggreg">na.rm.aggreg<a class="anchor" aria-label="anchor" href="#arg-na-rm-aggreg"></a></dt>
<dd><p>a logical flag indicating whether <code>NA</code> should be remove to prevent
propagation through <code>aggreg.fun</code>. Can be useful to set to TRUE with
unbalanced design as those will generate structural <code>NA</code>s in
<code>$Estimations</code>. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-methodopticlust">methodOptiClust<a class="anchor" aria-label="anchor" href="#arg-methodopticlust"></a></dt>
<dd><p>character string indicating how the "optimal"" number
of clusters is computed from the gap statistics and their standard
deviations. Possible values are <code>"globalmax"</code>, <code>"firstmax"</code>,
<code>"Tibs2001SEmax"</code>, <code>"firstSEmax"</code> and <code>"globalSEmax"</code>.
Default is <code>"firstSEmax"</code>.  See <code>'method'</code> in
<code><a href="https://rdrr.io/pkg/cluster/man/clusGap.html" class="external-link">clusGap</a></code>, Details and <em>Tibshirani et al.,
2001</em> in References.</p></dd>


<dt id="arg-indiv">indiv<a class="anchor" aria-label="anchor" href="#arg-indiv"></a></dt>
<dd><p>a character string indicating by which unit observations are
aggregated (through <code>aggreg.fun</code>) before the clustering.  Possible
values are <code>"genes"</code> or <code>"patients"</code>.  Default is <code>"genes"</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical flag enabling verbose messages to track the computing
status of the function.  Default is <code>TRUE</code>.</p></dd>


<dt id="arg-clust-trends">clust_trends<a class="anchor" aria-label="anchor" href="#arg-clust-trends"></a></dt>
<dd><p>object of class <b><a href="clustTrend.html">ClusteredTrends</a></b> containing
already computed trends for the plotted gene sets.  Default is <code>NULL</code>.</p></dd>


<dt id="arg-n-clusters">N_clusters<a class="anchor" aria-label="anchor" href="#arg-n-clusters"></a></dt>
<dd><p>an integer that is the number of clusters in which the
dynamics should be regrouped. The cutoff of the clustering tree is
automatically calculated accordingly.  Default is <code>NULL</code>, in which case
the dendrogram is not cut and no clusters are identified.</p></dd>


<dt id="arg-myclusters">myclusters<a class="anchor" aria-label="anchor" href="#arg-myclusters"></a></dt>
<dd><p>a character vector of colors for predefined clusters of the
represented gene sets, with as many levels as the value of <code>N_clusters</code>.
Default is <code>NULL</code>, in which case the clusters are automatically
identified and colored via the <code><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></code> function and the
<code>N_clusters</code> argument only.</p></dd>


<dt id="arg-label-clusters">label.clusters<a class="anchor" aria-label="anchor" href="#arg-label-clusters"></a></dt>
<dd><p>if <code>N_clusters</code> is not <code>NULL</code>, a character
vector of length <code>N_clusterss</code>.  Default is <code>NULL</code>, in which case
if <code>N_clusters</code> is not <code>NULL</code>, clusters are simply labeled with
numbers.</p></dd>


<dt id="arg-prev-rowcl">prev_rowCL<a class="anchor" aria-label="anchor" href="#arg-prev-rowcl"></a></dt>
<dd><p>a <b><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></b> object, such as the one return by the
present plotting function (see Value) for instance.  If not <code>NULL</code>, no
clustering is calculated by the present plotting function and this tree is
used to represent the gene sets dynamics.  Default is <code>NULL</code>.</p></dd>


<dt id="arg-descript">descript<a class="anchor" aria-label="anchor" href="#arg-descript"></a></dt>
<dd><p>logical flag indicating that the description of the gene sets
should appear after their name on the right side of the plot if <code>TRUE</code>.
Default is <code>TRUE</code>.  See Details.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>logical flag indicating whether the heatmap should be plotted or
not.  Default is <code>TRUE</code>.</p></dd>


<dt id="arg-color-vec">color.vec<a class="anchor" aria-label="anchor" href="#arg-color-vec"></a></dt>
<dd><p>a character strings vector used to define the color
<a href="https://rdrr.io/r/grDevices/palette.html" class="external-link">palette</a> used in the plot.  Default is
<code>c("#D73027", "#FC8D59","lightyellow", "#91BFDB", "#4575B4")</code>.</p></dd>


<dt id="arg-legend-breaks">legend.breaks<a class="anchor" aria-label="anchor" href="#arg-legend-breaks"></a></dt>
<dd><p>a numeric vector indicating the splitting points for
coloring.  Default is <code>NULL</code>, in which case the break points will be
spaced equally and symmetrically about 0.</p></dd>


<dt id="arg-label-column">label.column<a class="anchor" aria-label="anchor" href="#arg-label-column"></a></dt>
<dd><p>a vector of character strings with the labels to be
displayed for the columns (i.e. the time points).  Default is <code>NULL</code>.</p></dd>


<dt id="arg-time-unit">time_unit<a class="anchor" aria-label="anchor" href="#arg-time-unit"></a></dt>
<dd><p>the time unit to be displayed (such as <code>"Y"</code>,
<code>"M"</code>, <code>"W"</code>, <code>"D"</code>, <code>"H"</code>, etc) next to the values of
<code>TimePoint</code> in the columns labels when <code>label.column</code> is
<code>NULL</code>.  Default is <code>""</code>.</p></dd>


<dt id="arg-cex-label-row">cex.label.row<a class="anchor" aria-label="anchor" href="#arg-cex-label-row"></a></dt>
<dd><p>a numerical value giving the amount by which row labels
text should be magnified relative to the default <code>1</code>.</p></dd>


<dt id="arg-cex-label-column">cex.label.column<a class="anchor" aria-label="anchor" href="#arg-cex-label-column"></a></dt>
<dd><p>a numerical value giving the amount by which column
labels text should be magnified relative to the default <code>1</code>.</p></dd>


<dt id="arg-margins">margins<a class="anchor" aria-label="anchor" href="#arg-margins"></a></dt>
<dd><p>numeric vector of length 2 containing the margins (see
<code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a>(mar= *))</code> for column and row names, respectively.  Default
is <code>c(15, 100)</code>.  See Details.</p></dd>


<dt id="arg-heatkey-size">heatKey.size<a class="anchor" aria-label="anchor" href="#arg-heatkey-size"></a></dt>
<dd><p>the size of the color key for the heatmap fill.  Default
is <code>1</code>.</p></dd>


<dt id="arg-dendrogram-size">dendrogram.size<a class="anchor" aria-label="anchor" href="#arg-dendrogram-size"></a></dt>
<dd><p>the horizontal size of the dendrogram.  Default is <code>1</code></p></dd>


<dt id="arg-heatmap-height">heatmap.height<a class="anchor" aria-label="anchor" href="#arg-heatmap-height"></a></dt>
<dd><p>the height of the heatmap.  Default is <code>1</code></p></dd>


<dt id="arg-heatmap-width">heatmap.width<a class="anchor" aria-label="anchor" href="#arg-heatmap-width"></a></dt>
<dd><p>the width of the heatmap.  Default is <code>1</code></p></dd>


<dt id="arg-cex-clusterkey">cex.clusterKey<a class="anchor" aria-label="anchor" href="#arg-cex-clusterkey"></a></dt>
<dd><p>a numerical value giving the amount by which the
clusters legend text should be magnified relative to the default <code>1</code>,
when <code>N_clusters</code> is not <code>NULL</code>.</p></dd>


<dt id="arg-cex-main">cex.main<a class="anchor" aria-label="anchor" href="#arg-cex-main"></a></dt>
<dd><p>a numerical value giving the amount by which title text
should be magnified relative to the default <code>1</code>.</p></dd>


<dt id="arg-horiz-clusterkey">horiz.clusterKey<a class="anchor" aria-label="anchor" href="#arg-horiz-clusterkey"></a></dt>
<dd><p>a logical flag; if <code>TRUE</code>, set the legend for
clusters horizontally rather than vertically.  Only used if the
<code>N_clusters</code> argument is not <code>NULL</code>.  Default is <code>TRUE</code>.</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>a character string for an optional title.  Default is <code>NULL</code>.</p></dd>


<dt id="arg-subtitle">subtitle<a class="anchor" aria-label="anchor" href="#arg-subtitle"></a></dt>
<dd><p>a character string for an optional subtitle.  Default is <code>NULL</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other parameters to be passed through to plotting functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <b><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></b> which describes the tree
produced by the clustering process.  The object is a list with components:</p><ul><li><p><code>merge</code> an \(n-1\) by \(2\) matrix.  Row \(i\) of
<code>merge</code> describes the merging of clusters at step i of the clustering.
If an element \(j\) in the row is negative, then observation -\(j\) was
merged at this stage.  If \(j\) is positive then the merge was with the
cluster formed at the (earlier) stage \(j\) of the algorithm.  Thus
negative entries in merge indicate agglomerations of singletons, and positive
entries indicate agglomerations of non-singletons.</p></li>
<li><p><code>height</code> a set of \(n-1\) real values (non-decreasing for
ultrametric trees).  The clustering height: that is, the value of the
criterion associated with the Ward clustering method.</p></li>
<li><p><code>order</code> a vector giving the permutation of the original
observations suitable for plotting, in the sense that a cluster plot using
this ordering and matrix merge will not have crossings of the branches.</p></li>
<li><p><code>labels</code> the gene set trends name.</p></li>
<li><p><code>call</code> the call which produced the result clustering:
<br><code>hclust(d = dist(map2heat, method = "euclidean"), method = "ward.D2")</code></p></li>
<li><p><code>method</code> "ward.D2", as it is the clustering method that has been used
for clustering the gene set trends.</p></li>
<li><p><code>dist.method</code> "euclidean", as it is the distance that has been used
for clustering the gene set trends.</p></li>
<li><p><code>legend.breaks</code> a numeric vector giving the splitting points used
for coloring the heatmap.  If <code>plot</code> is <code>FALSE</code>, then it is
<code>NULL</code>.</p></li>
<li><p><code>myclusters</code> a character vector of colors for the dynamic clusters
of the represented gene set trends, with as many levels as the value of
<code>N_clusters</code>.  If no dynamic clusters were represented, than this is
<code>NULL</code>.</p></li>
<li><p><code>ddr</code> a <b>dendrogram</b> object with the reordering used for the
heatmap.  See <code>heatmap.2</code> function from package
<code>gplots</code>.</p></li>
<li><p>gene set.names character vector with the names of the gene sets
used in the heatmap.</p></li>
<li><p><code>clust.trends</code> a <b><a href="clustTrend.html">ClusteredTrends</a></b> object.</p></li>
<li><p><code>clustersExport</code> a data frame with 2 variables containing the two
following variables :</p><ul><li><p><code>GeneSet</code>: the gene set trends
clustered.</p></li>
<li><p><code>Cluster</code>: the dynamic cluster they belong to.</p></li>
</ul><p>The
data frame is order by the variable <code>Cluster</code>.</p></li>
<li><p><code>data_plotted</code>: the data matrix represented by the heatmap</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>On the heatmap, each line corresponds to a gene set, and each column to a
time point.</p>
<p>If <code>expr</code> is a matrix or a dataframe, then the "original" data are
plotted.  On the other hand, if <code>expr</code> is a list returned in the
<code>'Estimations'</code> element of <code><a href="TcGSA.LR.html">TcGSA.LR</a></code>, then it is those
"estimations" made by the <code><a href="TcGSA.LR.html">TcGSA.LR</a></code> function that are plotted.</p>
<p>If <code>descript</code> is <code>FALSE</code>, the second element of <code>margins</code> can
be reduced (for instance use <code>margins = c(5, 10)</code>), as there is not so
much need for space in order to display only the gene set names, without
their description.</p>
<p>If there is a large number of significant gene sets, the hierarchical clustering
step repeated for each of them can take a few minutes. To speed things up
(especially) when playing with the plotting parameters for having a nice plot,
one can run the <code>clustTrend</code> function beforehand, and plug its results
in the <code>plot.TcGSA</code> function via the <code>clust_trends</code> argument.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hejblum BP, Skinner J, Thiebaut R, (2015)
Time-Course Gene Set Analysis for Longitudinal Gene Expression Data.
<em>PLOS Comput. Biol.</em> 11(6): e1004310.
doi: 10.1371/journal.pcbi.1004310</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="TcGSA.LR.html">TcGSA.LR</a></code>,
<code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Boris P. Hejblum</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data_simu_TcGSA</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tcgsa_sim_1grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="TcGSA.LR.html">TcGSA.LR</a></span><span class="op">(</span>expr<span class="op">=</span><span class="va">expr_1grp</span>, gmt<span class="op">=</span><span class="va">gmt_sim</span>, design<span class="op">=</span><span class="va">design</span>, </span></span>
<span class="r-in"><span>                          subject_name<span class="op">=</span><span class="st">"Patient_ID"</span>, time_name<span class="op">=</span><span class="st">"TimePoint"</span>,</span></span>
<span class="r-in"><span>                          time_func<span class="op">=</span><span class="st">"linear"</span>, crossedRandom<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tcgsa_sim_1grp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">tcgsa_sim_1grp</span>, expr<span class="op">=</span><span class="va">tcgsa_sim_1grp</span><span class="op">$</span><span class="va">Estimations</span>, </span></span>
<span class="r-in"><span>    Subject_ID<span class="op">=</span><span class="va">design</span><span class="op">$</span><span class="va">Patient_ID</span>, TimePoint<span class="op">=</span><span class="va">design</span><span class="op">$</span><span class="va">TimePoint</span>,</span></span>
<span class="r-in"><span>    baseline<span class="op">=</span><span class="fl">1</span>, </span></span>
<span class="r-in"><span>    B<span class="op">=</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>    time_unit<span class="op">=</span><span class="st">"H"</span>,</span></span>
<span class="r-in"><span>    dendrogram.size<span class="op">=</span><span class="fl">0.4</span>, heatmap.width<span class="op">=</span><span class="fl">0.8</span>, heatmap.height<span class="op">=</span><span class="fl">2</span>, cex.main<span class="op">=</span><span class="fl">0.7</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>           </span></span>
<span class="r-in"><span><span class="va">tcgsa_sim_2grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="TcGSA.LR.html">TcGSA.LR</a></span><span class="op">(</span>expr<span class="op">=</span><span class="va">expr_2grp</span>, gmt<span class="op">=</span><span class="va">gmt_sim</span>, design<span class="op">=</span><span class="va">design</span>, </span></span>
<span class="r-in"><span>                          subject_name<span class="op">=</span><span class="st">"Patient_ID"</span>, time_name<span class="op">=</span><span class="st">"TimePoint"</span>,</span></span>
<span class="r-in"><span>                          time_func<span class="op">=</span><span class="st">"linear"</span>, crossedRandom<span class="op">=</span><span class="cn">FALSE</span>, </span></span>
<span class="r-in"><span>                          group_name<span class="op">=</span><span class="st">"group.var"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tcgsa_sim_2grp</span><span class="op">)</span>                             </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">tcgsa_sim_2grp</span>, expr<span class="op">=</span><span class="va">expr_2grp</span>, </span></span>
<span class="r-in"><span>    Subject_ID<span class="op">=</span><span class="va">design</span><span class="op">$</span><span class="va">Patient_ID</span>, TimePoint<span class="op">=</span><span class="va">design</span><span class="op">$</span><span class="va">TimePoint</span>,</span></span>
<span class="r-in"><span>    B<span class="op">=</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>    time_unit<span class="op">=</span><span class="st">"H"</span>,</span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://borishejblum.science" class="external-link">Boris P Hejblum</a>, Damien Chimits, Anthony Devaux.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

