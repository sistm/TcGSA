<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function computes the Likelihood Ratios for the gene sets under
scrutiny, as well as estimations of genes dynamics inside those gene sets
through mixed models."><title>Computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR • TcGSA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Computing the Likelihood Ratios for the Gene Sets under Scrutiny — TcGSA.LR"><meta property="og:description" content="This function computes the Likelihood Ratios for the gene sets under
scrutiny, as well as estimations of genes dynamics inside those gene sets
through mixed models."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">TcGSA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/TcGSA_userguide.html">User guide to the `TcGSA` R package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sistm/TcGSA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Computing the Likelihood Ratios for the Gene Sets under Scrutiny</h1>
      <small class="dont-index">Source: <a href="https://github.com/sistm/TcGSA/blob/HEAD/R/TcGSA.LR.R" class="external-link"><code>R/TcGSA.LR.R</code></a></small>
      <div class="d-none name"><code>TcGSA.LR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes the Likelihood Ratios for the gene sets under
scrutiny, as well as estimations of genes dynamics inside those gene sets
through mixed models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">TcGSA.LR</span><span class="op">(</span>
  <span class="va">expr</span>,
  <span class="va">gmt</span>,
  <span class="va">design</span>,
  subject_name <span class="op">=</span> <span class="st">"Patient_ID"</span>,
  time_name <span class="op">=</span> <span class="st">"TimePoint"</span>,
  crossedRandom <span class="op">=</span> <span class="cn">FALSE</span>,
  covariates_fixed <span class="op">=</span> <span class="st">""</span>,
  time_covariates <span class="op">=</span> <span class="st">""</span>,
  time_func <span class="op">=</span> <span class="st">"linear"</span>,
  group_name <span class="op">=</span> <span class="st">""</span>,
  separateSubjects <span class="op">=</span> <span class="cn">FALSE</span>,
  minGSsize <span class="op">=</span> <span class="fl">10</span>,
  maxGSsize <span class="op">=</span> <span class="fl">500</span>
<span class="op">)</span>

<span class="co"># S3 method for TcGSA</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>expr</dt>
<dd><p>a matrix or dataframe of gene expression.  Its dimension are
\(n\)x\(p\), with the \(p\) samples in column and the \(n\) genes in
row.</p></dd>
<dt>gmt</dt>
<dd><p>a <b>gmt</b> object containing the gene sets definition.  See
<code><a href="https://rdrr.io/pkg/GSA/man/GSA.read.gmt.html" class="external-link">GSA.read.gmt</a></code> and definition on 
<a href="http://www.broadinstitute.org/cancer/software/gsea/wiki/index.php/Data_formats" class="external-link">www.broadinstitute.org</a>.</p></dd>
<dt>design</dt>
<dd><p>a matrix or dataframe containing the experimental variables that used in the model,
namely <code>subject_name</code>, <code>time_name</code>, and <code>covariates_fixed</code> 
and <code>time_covariates</code> if applicable.  Its dimension are \(p\)x\(m\) 
and its row are is in the same order as the columns of <code>expr</code>.</p></dd>
<dt>subject_name</dt>
<dd><p>the name of the factor variable from <code>design</code> that contains the information on 
the repetition units used in the mixed model, such as the patient identifiers for instance.  
Default is <code>'Patient_ID'</code>.  See Details.</p></dd>
<dt>time_name</dt>
<dd><p>the name of a numeric variable from <code>design</code> that contains 
the information on the time replicates (the time points at which gene 
expression was measured).  Default is <code>'TimePoint'</code>.  See Details.</p></dd>
<dt>crossedRandom</dt>
<dd><p>logical flag indicating whether the random effects of the subjects and of the time points
should be modeled as one crossed random effect or as two separated random effects.  
Default is <code>FALSE</code>. See details.</p></dd>
<dt>covariates_fixed</dt>
<dd><p>a character vector with the names of numeric or factor variables from the <code>design</code> 
matrix that should appear as fixed effects in the model.  See details.
Default is <code>""</code>, which corresponds to no covariates in the model.</p></dd>
<dt>time_covariates</dt>
<dd><p>a character vector with the names of numeric or factor variables from the <code>design</code> 
matrix that should appear as fixed effects interaction with the <code>time_name</code> 
variable in the model.  See details.  Default is <code>""</code>, which corresponds 
to no covariates in the model.</p></dd>
<dt>time_func</dt>
<dd><p>the form of the time trend. Can be either one of <code>"linear"</code>,
<code>"cubic"</code>, <code>"splines"</code> or specified by the user, or the column name of 
a factor variable from <code>design</code>. If specified by the user, 
it must be as an expression using only names of variables from the <code>design</code> matrix 
with only the three following operators: <code>+</code>, <code>*</code>, <code>/</code> . 
The <code>"splines"</code> form corresponds to the natural cubic B-splines 
(see also <code><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></code>).  If there are only a few timepoints, 
a <code>"linear"</code> form should be sufficient. Otherwise, the <code>"cubic"</code> form is 
more parsimonious than the <code>"splines"</code> form, and should be sufficiently flexible.
If the column name of a factor variable from <code>design</code> is supplied, 
then time is considered as discrete in the analysis.
If the user specify a formula using column names from design, both factor and numeric
variables can be used.</p></dd>
<dt>group_name</dt>
<dd><p>in the case of several treatment groups, the name of a factor variable 
from the <code>design</code> matrix.  It indicates to which treatment group each sample
belongs to.  Default is <code>""</code>, which means that there is only one 
treatment group.  See Details.</p></dd>
<dt>separateSubjects</dt>
<dd><p>logical flag indicating that the analysis identifies
gene sets that discriminates patients rather than gene sets than have a
significant trend over time.  Default is <code>FALSE</code>.  See Details.</p></dd>
<dt>minGSsize</dt>
<dd><p>the minimum number of genes in a gene set.  If there are
less genes than this number in one of the gene sets under scrutiny, the
Likelihood Ratio of this gene set is not computed (the mixed model are not
fitted). Default is <code>10</code> genes as the minimum.</p></dd>
<dt>maxGSsize</dt>
<dd><p>the maximum number of genes in a gene set.  If there are
more genes than this number in one of the gene sets under scrutiny, the
Likelihood Ratio of this gene set is not computed (the mixed model are not
fitted).  This is to avoid very long computation times.  Default is
<code>500</code> genes as the maximum.</p></dd>
<dt>x</dt>
<dd><p>an object of class '<code>TcGSA</code>'.</p></dd>
<dt>...</dt>
<dd><p>further arguments passed to or from other methods.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>TcGSA.LR</code> returns a <code>tcgsa</code> object, which is a list with
the 5 following elements:</p><ul><li><p>fit a data frame that contains the 3 following variables:</p><ul><li><p><code>LR</code>: the likelihood ratio between the model under the
null hypothesis and the model under the alternative hypothesis.</p></li>
<li><p><code>CVG_H0</code>: convergence status of the model under the null hypothesis.</p></li>
<li><p><code>CVG_H1</code>: convergence status of the model under the alternative
hypothesis.</p></li>
</ul></li>
<li><p><code>time_func</code>: a character string passing along the value of the
<code>time_func</code> argument used in the call.</p></li>
<li><p><code>GeneSets_gmt</code>: a <code>gmt</code> object passing along the value of the
<code>gmt</code> argument used in the call.</p></li>
<li><p><code>group.var</code>: a factor passing along the <code>group_name</code> variable
from the <code>design</code> matrix.</p></li>
<li><p><code>separateSubjects</code>: a logical flag passing along the value of the
<code>separateSubjects</code> argument used in the call.</p></li>
<li><p><code>Estimations</code>: a list of 3 dimensions arrays.  Each element of the
list (i.e. each array) corresponds to the estimations of gene expression
dynamics for each of the gene sets under scrutiny (obtained from mixed
models).  The first dimension of those arrays is the genes included in the
concerned gene set, the second dimension is the <code>Patient_ID</code>, and the
third dimension is the <code>TimePoint</code>.  The values inside those arrays are
estimated gene expressions.</p></li>
<li><p><code>time_DF</code>: the degree of freedom of the natural splines functions</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This Time-course Gene Set Analysis aims at identifying gene sets that are not
stable over time, either homogeneously or heterogeneously (see <em>Hejblum
et al, 2012</em>)in terms of their probes.  And when the argument
<code>separateSubjects</code> is <code>TRUE</code>, instead of identifying gene sets that
have a significant trend over time, <em>TcGSA</em> identifies gene sets that
have significantly different trends over time depending on <code>Subjects</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hejblum BP, Skinner J, Thiebaut R, (2015) 
Time-Course Gene Set Analysis for Longitudinal Gene Expression Data. 
<em>PLOS Comput. Biol.</em> 11(6):e1004310.
doi: 10.1371/journal.pcbi.1004310</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="summary.TcGSA.html">summary.TcGSA</a></code>, <code><a href="plot.TcGSA.html">plot.TcGSA</a></code>, 
and <code><a href="TcGSA.LR.parallel.html">TcGSA.LR.parallel</a></code> for an implementation using 
parallel computing</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Boris P. Hejblum</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data_simu_TcGSA</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">tcgsa_sim_1grp</span> <span class="op">&lt;-</span> <span class="fu">TcGSA.LR</span><span class="op">(</span>expr<span class="op">=</span><span class="va">expr_1grp</span>, gmt<span class="op">=</span><span class="va">gmt_sim</span>, design<span class="op">=</span><span class="va">design</span>, </span>
<span class="r-in">                          subject_name<span class="op">=</span><span class="st">"Patient_ID"</span>, time_name<span class="op">=</span><span class="st">"TimePoint"</span>,</span>
<span class="r-in">                          time_func<span class="op">=</span><span class="st">"linear"</span>, crossedRandom<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">tcgsa_sim_1grp</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tcgsa_sim_1grp</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">tcgsa_sim_1grp</span>, expr<span class="op">=</span><span class="va">expr_1grp</span>, </span>
<span class="r-in">    Subject_ID<span class="op">=</span><span class="va">design</span><span class="op">$</span><span class="va">Patient_ID</span>, TimePoint<span class="op">=</span><span class="va">design</span><span class="op">$</span><span class="va">TimePoint</span>,</span>
<span class="r-in">    baseline<span class="op">=</span><span class="fl">1</span>, </span>
<span class="r-in">    B<span class="op">=</span><span class="fl">100</span>,</span>
<span class="r-in">    time_unit<span class="op">=</span><span class="st">"H"</span></span>
<span class="r-in">    <span class="op">)</span></span>
<span class="r-in">       </span>
<span class="r-in"><span class="va">tcgsa_sim_2grp</span> <span class="op">&lt;-</span> <span class="fu">TcGSA.LR</span><span class="op">(</span>expr<span class="op">=</span><span class="va">expr_2grp</span>, gmt<span class="op">=</span><span class="va">gmt_sim</span>, design<span class="op">=</span><span class="va">design</span>,</span>
<span class="r-in">                          subject_name<span class="op">=</span><span class="st">"Patient_ID"</span>, time_name<span class="op">=</span><span class="st">"TimePoint"</span>,</span>
<span class="r-in">                          time_func<span class="op">=</span><span class="st">"linear"</span>, crossedRandom<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span class="r-in">                          group_name<span class="op">=</span><span class="st">"group.var"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">tcgsa_sim_2grp</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://borishejblum.science" class="external-link">Boris P Hejblum</a>, Damien Chimits, Anthony Devaux.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

