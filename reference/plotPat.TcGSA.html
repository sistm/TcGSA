<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function plots a series of gene sets dynamic trends heatmaps.  One
heatmap is drawn for each patient. NOT IMPLEMENTED YET (TODO)"><title>Plot a Gene Set Trends Heatmap for each Patient. — plotPat.TcGSA • TcGSA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot a Gene Set Trends Heatmap for each Patient. — plotPat.TcGSA"><meta property="og:description" content="This function plots a series of gene sets dynamic trends heatmaps.  One
heatmap is drawn for each patient. NOT IMPLEMENTED YET (TODO)"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">TcGSA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/TcGSA_userguide.html">User guide to the `TcGSA` R package</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sistm/TcGSA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plot a Gene Set Trends Heatmap for each Patient.</h1>
      <small class="dont-index">Source: <a href="https://github.com/sistm/TcGSA/blob/HEAD/R/plotPat.TcGSA.R" class="external-link"><code>R/plotPat.TcGSA.R</code></a></small>
      <div class="d-none name"><code>plotPat.TcGSA.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function plots a series of gene sets dynamic trends heatmaps.  One
heatmap is drawn for each patient. NOT IMPLEMENTED YET (TODO)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plotPat.TcGSA</span><span class="op">(</span>
  <span class="va">x</span>,
  threshold <span class="op">=</span> <span class="fl">0.05</span>,
  myproc <span class="op">=</span> <span class="st">"BY"</span>,
  nbsimu_pval <span class="op">=</span> <span class="fl">1e+06</span>,
  <span class="va">expr</span>,
  <span class="va">Subject_ID</span>,
  <span class="va">TimePoint</span>,
  baseline <span class="op">=</span> <span class="cn">NULL</span>,
  only.signif <span class="op">=</span> <span class="cn">TRUE</span>,
  group.var <span class="op">=</span> <span class="cn">NULL</span>,
  Group_ID_paired <span class="op">=</span> <span class="cn">NULL</span>,
  ref <span class="op">=</span> <span class="cn">NULL</span>,
  group_of_interest <span class="op">=</span> <span class="cn">NULL</span>,
  FUNcluster <span class="op">=</span> <span class="cn">NULL</span>,
  clustering_metric <span class="op">=</span> <span class="st">"euclidian"</span>,
  clustering_method <span class="op">=</span> <span class="st">"ward"</span>,
  B <span class="op">=</span> <span class="fl">500</span>,
  max_trends <span class="op">=</span> <span class="fl">4</span>,
  aggreg.fun <span class="op">=</span> <span class="st">"median"</span>,
  na.rm.aggreg <span class="op">=</span> <span class="cn">TRUE</span>,
  methodOptiClust <span class="op">=</span> <span class="st">"firstSEmax"</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>,
  clust_trends <span class="op">=</span> <span class="cn">NULL</span>,
  N_clusters <span class="op">=</span> <span class="cn">NULL</span>,
  myclusters <span class="op">=</span> <span class="cn">NULL</span>,
  label.clusters <span class="op">=</span> <span class="cn">NULL</span>,
  prev_rowCL <span class="op">=</span> <span class="cn">NULL</span>,
  descript <span class="op">=</span> <span class="cn">TRUE</span>,
  plotAll <span class="op">=</span> <span class="cn">TRUE</span>,
  color.vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkred"</span>, <span class="st">"#D73027"</span>, <span class="st">"#FC8D59"</span>, <span class="st">"snow"</span>, <span class="st">"#91BFDB"</span>, <span class="st">"#4575B4"</span>,
    <span class="st">"darkblue"</span><span class="op">)</span>,
  legend.breaks <span class="op">=</span> <span class="cn">NULL</span>,
  label.column <span class="op">=</span> <span class="cn">NULL</span>,
  time_unit <span class="op">=</span> <span class="st">""</span>,
  cex.label.row <span class="op">=</span> <span class="fl">1</span>,
  cex.label.column <span class="op">=</span> <span class="fl">1</span>,
  margins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">25</span><span class="op">)</span>,
  heatKey.size <span class="op">=</span> <span class="fl">1</span>,
  dendrogram.size <span class="op">=</span> <span class="fl">1</span>,
  heatmap.height <span class="op">=</span> <span class="fl">1</span>,
  heatmap.width <span class="op">=</span> <span class="fl">1</span>,
  cex.clusterKey <span class="op">=</span> <span class="fl">1</span>,
  cex.main <span class="op">=</span> <span class="fl">1</span>,
  horiz.clusterKey <span class="op">=</span> <span class="cn">TRUE</span>,
  main <span class="op">=</span> <span class="cn">NULL</span>,
  subtitle <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>a <b>tcgsa</b> object.</p></dd>
<dt>threshold</dt>
<dd><p>the threshold at which the FDR or the FWER should be controlled.</p></dd>
<dt>myproc</dt>
<dd><p>a vector of character strings containing the names of the
multiple testing procedures for which adjusted p-values are to be computed.
This vector should include any of the following: "<code>Bonferroni</code>",
"<code>Holm</code>", "<code>Hochberg</code>", "<code>SidakSS</code>", "<code>SidakSD</code>",
"<code>BH</code>", "<code>BY</code>", "<code>ABH</code>", "<code>TSBH</code>" or "<code>none</code>".  
"<code>none</code>" indicates no adjustment for multiple testing. See
<code><a href="https://rdrr.io/pkg/multtest/man/mt.rawp2adjp.html" class="external-link">mt.rawp2adjp</a></code> for details.  Default is
"<code>BY</code>", the Benjamini &amp; Yekutieli (2001) step-up FDR-controlling
procedure (general dependency structures).  In order to control the FWER(in
case of an analysis that is more a hypothesis confirmation than an
exploration of the expression data), we recommend to use "<code>Holm</code>", the
Holm (1979) step-down adjusted p-values for strong control of the FWER.</p></dd>
<dt>nbsimu_pval</dt>
<dd><p>the number of observations under the null distribution to
be generated in order to compute the p-values. Default is <code>1e+06</code>.</p></dd>
<dt>expr</dt>
<dd><p>either a matrix or dataframe of gene expression upon which
dynamics are to be calculated, or a list of gene sets estimation of gene
expression.  In the case of a matrix or dataframe, its dimension are \(n\)
x \(p\), with the \(p\) sample in column and the \(n\) genes in row.
In the case of a list, its length should correspond to the number of gene
sets under scrutiny and each element should be an 3 dimension array of
estimated gene expression, such as for the list returned in the
<code>'Estimations'</code> element of <code><a href="TcGSA.LR.html">TcGSA.LR</a></code>.  See Details.</p></dd>
<dt>Subject_ID</dt>
<dd><p>a factor of length \(p\) that is in the same order as the
columns of <code>expr</code> (when it is a dataframe) and that contains the patient
identifier of each sample.</p></dd>
<dt>TimePoint</dt>
<dd><p>a numeric vector or a factor of length \(p\) that is in
the same order as <code>Subject_ID</code> and the columns of <code>expr</code> (when it
is a dataframe), and that contains the time points at which gene expression
was measured.</p></dd>
<dt>baseline</dt>
<dd><p>a character string which is the value of <code>TimePoint</code>
used as baseline.</p></dd>
<dt>only.signif</dt>
<dd><p>logical flag for plotting only the significant gene sets.
If <code>FALSE</code>, all the gene sets from the <b>gmt</b> object contained in
<code>x</code> are plotted.  Default is <code>TRUE</code>.</p></dd>
<dt>group.var</dt>
<dd><p>in the case of several treatment groups, this is a factor of
length \(p\) that is in the same order as <code>Timepoint</code>,
<code>Subject_ID</code>, <code>sample_name</code> and the columns of <code>expr</code>.  It
indicates to which treatment group each sample belongs to.  Default is
<code>NULL</code>, which means that there is only one treatment group.  See
Details.</p></dd>
<dt>Group_ID_paired</dt>
<dd><p>a character vector of length \(p\) that is in the
same order as <code>Timepoint</code>, <code>Subject_ID</code>, <code>sample_name</code>,
<code>group.var</code> and the columns of <code>expr</code>.  This argument must not be
<code>NULL</code> in the case of a paired analysis, and must be <code>NULL</code>
otherwise.  Default is <code>NULL</code>.</p></dd>
<dt>ref</dt>
<dd><p>the group which is used as reference in the case of several
treatment groups.  Default is <code>NULL</code>, which means that reference is the
first group in alphabetical order of the labels of <code>group.var</code>.  See
Details.</p></dd>
<dt>group_of_interest</dt>
<dd><p>the group of interest, for which dynamics are to be
computed in the case of several treatment groups.  Default is <code>NULL</code>,
which means that group of interest is the second group in alphabetical order
of the labels of <code>group.var</code>.</p></dd>
<dt>FUNcluster</dt>
<dd><p>the clustering function used to agglomerate genes in
trends.  Default is <code>NULL</code>, in which a hierarchical clustering is
performed via the function <code><a href="https://rdrr.io/pkg/cluster/man/agnes.html" class="external-link">agnes</a></code>, using the
metric <code>clustering_metric</code> and the method <code>clustering_method</code>.  See
<code><a href="https://rdrr.io/pkg/cluster/man/clusGap.html" class="external-link">clusGap</a></code></p></dd>
<dt>clustering_metric</dt>
<dd><p>character string specifying the metric to be used
for calculating dissimilarities between observations in the hierarchical
clustering when <code>FUNcluster</code> is <code>NULL</code>.  The currently available
options are <code>"euclidean"</code> and <code>"manhattan"</code>.  Default is
<code>"euclidean"</code>.  See <code><a href="https://rdrr.io/pkg/cluster/man/agnes.html" class="external-link">agnes</a></code>.  Also, a <code>"sts"</code> option 
is available in TcGSA.  It implements the 'Short Time Series' distance 
[Moller-Levet et al., Fuzzy Clustering of short time series and unevenly distributed 
sampling points, <em>Advances in Intelligent Data Analysis V</em>:330-340 Springer, 2003]
designed specifically for clustering time series.</p></dd>
<dt>clustering_method</dt>
<dd><p>character string defining the agglomerative method
to be used in the hierarchical clustering when <code>FUNcluster</code> is
<code>NULL</code>.  The six methods implemented are <code>"average"</code> ([unweighted
pair-]group average method, UPGMA), <code>"single"</code> (single linkage),
<code>"complete"</code> (complete linkage), <code>"ward"</code> (Ward's method),
<code>"weighted"</code> (weighted average linkage).  Default is <code>"ward"</code>.  See
<code><a href="https://rdrr.io/pkg/cluster/man/agnes.html" class="external-link">agnes</a></code>.</p></dd>
<dt>B</dt>
<dd><p>integer specifying the number of Monte Carlo ("bootstrap") samples
used to compute the gap statistics.  Default is <code>500</code>.  See
<code><a href="https://rdrr.io/pkg/cluster/man/clusGap.html" class="external-link">clusGap</a></code>.</p></dd>
<dt>max_trends</dt>
<dd><p>integer specifying the maximum number of different clusters
to be tested.  Default is <code>4</code>.</p></dd>
<dt>aggreg.fun</dt>
<dd><p>a character string such as <code>"mean"</code>, <code>"median"</code>
or the name of any other statistics function defined that returns a single
numeric value.  It specifies the function used to aggregate the observations
before the clustering.  Default is to <code>median</code>.  Default is
<code>"median"</code>.</p></dd>
<dt>na.rm.aggreg</dt>
<dd><p>a logical flag indicating whether <code>NA</code> should be remove to prevent 
propagation through <code>aggreg.fun</code>. Can be useful to set to TRUE with 
unbalanced design as those will generate structural <code>NA</code>s in 
<code>$Estimations</code>. Default is <code>TRUE</code>.</p></dd>
<dt>methodOptiClust</dt>
<dd><p>character string indicating how the "optimal"" number
of clusters is computed from the gap statistics and their standard
deviations. Possible values are <code>"globalmax"</code>, <code>"firstmax"</code>,
<code>"Tibs2001SEmax"</code>, <code>"firstSEmax"</code> and <code>"globalSEmax"</code>.
Default is <code>"firstSEmax"</code>.  See <code>'method'</code> in
<code><a href="https://rdrr.io/pkg/cluster/man/clusGap.html" class="external-link">clusGap</a></code>, Details and <em>Tibshirani et al.,
2001</em> in References.</p></dd>
<dt>verbose</dt>
<dd><p>logical flag enabling verbose messages to track the computing
status of the function.  Default is <code>TRUE</code>.</p></dd>
<dt>clust_trends</dt>
<dd><p>object of class <b><a href="clustTrend.html">ClusteredTrends</a></b> containing
already computed trends for the plotted gene sets.  Default is <code>NULL</code>.</p></dd>
<dt>N_clusters</dt>
<dd><p>an integer that is the number of clusters in which the
dynamics should be regrouped. The cutoff of the clustering tree is
automatically calculated accordingly.  Default is <code>NULL</code>, in which case
the dendrogram is not cut and no clusters are identified.</p></dd>
<dt>myclusters</dt>
<dd><p>a character vector of colors for predefined clusters of the
represented gene sets, with as many levels as the value of <code>N_clusters</code>.
Default is <code>NULL</code>, in which case the clusters are automatically
identified and colored via the <code><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">cutree</a></code> function and the
<code>N_clusters</code> argument only.</p></dd>
<dt>label.clusters</dt>
<dd><p>if <code>N_clusters</code> is not <code>NULL</code>, a character
vector of length <code>N_clusterss</code>.  Default is <code>NULL</code>, in which case
if <code>N_clusters</code> is not <code>NULL</code>, clusters are simply labeled with
numbers.</p></dd>
<dt>prev_rowCL</dt>
<dd><p>a <b><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></b> object, such as the one return by the
present plotting function (see Value) for instance.  If not <code>NULL</code>, no
clustering is calculated by the present plotting function and this tree is
used to represent the gene sets dynamics.  Default is <code>NULL</code>.</p></dd>
<dt>descript</dt>
<dd><p>logical flag indicating that the description of the gene sets
should appear after their name on the right side of the plot if <code>TRUE</code>.
Default is <code>TRUE</code>.  See Details.</p></dd>
<dt>plotAll</dt>
<dd><p>logical flag indicating whether a first heatmap with the median
over all the patients should be plotted, or not.  Default is <code>TRUE</code>.</p></dd>
<dt>color.vec</dt>
<dd><p>a character strings vector used to define the color
<a href="https://rdrr.io/r/grDevices/palette.html" class="external-link">palette</a> used in the plot.  Default is
<code>c("#D73027", "#FC8D59","lightyellow", "#91BFDB", "#4575B4")</code>.</p></dd>
<dt>legend.breaks</dt>
<dd><p>a numeric vector indicating the splitting points for
coloring.  Default is <code>NULL</code>, in which case the break points will be
spaced equally and symmetrically about 0.</p></dd>
<dt>label.column</dt>
<dd><p>a vector of character strings with the labels to be
displayed for the columns (i.e. the time points).  Default is <code>NULL</code>.</p></dd>
<dt>time_unit</dt>
<dd><p>the time unit to be displayed (such as <code>"Y"</code>,
<code>"M"</code>, <code>"W"</code>, <code>"D"</code>, <code>"H"</code>, etc) next to the values of
<code>TimePoint</code> in the columns labels when <code>label.column</code> is
<code>NULL</code>.  Default is <code>""</code>.</p></dd>
<dt>cex.label.row</dt>
<dd><p>a numerical value giving the amount by which row labels
text should be magnified relative to the default <code>1</code>.</p></dd>
<dt>cex.label.column</dt>
<dd><p>a numerical value giving the amount by which column
labels text should be magnified relative to the default <code>1</code>.</p></dd>
<dt>margins</dt>
<dd><p>numeric vector of length 2 containing the margins (see
<code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a>(mar= *))</code> for column and row names, respectively.  Default
is <code>c(15, 100)</code>.  See Details.</p></dd>
<dt>heatKey.size</dt>
<dd><p>the size of the color key for the heatmap fill.  Default
is <code>1</code>.</p></dd>
<dt>dendrogram.size</dt>
<dd><p>the horizontal size of the dendrogram.  Default is
<code>1</code></p></dd>
<dt>heatmap.height</dt>
<dd><p>the height of the heatmap.  Default is <code>1</code></p></dd>
<dt>heatmap.width</dt>
<dd><p>the width of the heatmap.  Default is <code>1</code></p></dd>
<dt>cex.clusterKey</dt>
<dd><p>a numerical value giving the amount by which the
clusters legend text should be magnified relative to the default <code>1</code>,
when <code>N_clusters</code> is not <code>NULL</code>.</p></dd>
<dt>cex.main</dt>
<dd><p>a numerical value giving the amount by which title text
should be magnified relative to the default <code>1</code>.</p></dd>
<dt>horiz.clusterKey</dt>
<dd><p>a logical flag; if <code>TRUE</code>, set the legend for
clusters horizontally rather than vertically.  Only used if the
<code>N_clusters</code> argument is not <code>NULL</code>.  Default is <code>TRUE</code>.</p></dd>
<dt>main</dt>
<dd><p>a character string for an optional title.  Default is
<code>NULL</code>.</p></dd>
<dt>subtitle</dt>
<dd><p>a character string for an optional subtitle.  Default is
<code>NULL</code>.</p></dd>
<dt>...</dt>
<dd><p>other parameters to be passed through to plotting functions.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <b><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></b> which describes the tree
produced by the clustering process.  The object is a list with components:</p><ul><li><p><code>merge</code> an \(n-1\) by \(2\) matrix.  Row \(i\) of
<code>merge</code> describes the merging of clusters at step i of the clustering.
If an element \(j\) in the row is negative, then observation -\(j\) was
merged at this stage.  If \(j\) is positive then the merge was with the
cluster formed at the (earlier) stage \(j\) of the algorithm.  Thus
negative entries in merge indicate agglomerations of singletons, and positive
entries indicate agglomerations of non-singletons.</p></li>
<li><p><code>height</code> a set of \(n-1\) real values (non-decreasing for
ultrametric trees).  The clustering height: that is, the value of the
criterion associated with the Ward clustering method.</p></li>
<li><p><code>order</code> a vector giving the permutation of the original
observations suitable for plotting, in the sense that a cluster plot using
this ordering and matrix merge will not have crossings of the branches.</p></li>
<li><p><code>labels</code> the gene sets name.</p></li>
<li><p><code>call</code> the call which produced the result clustering:
<br><code>hclust(d = dist(map2heat, method = "euclidean"), method = "ward.D2")</code></p></li>
<li><p>method "ward.D2", as it is the clustering method that has been used
for clustering the gene set trends.</p></li>
<li><p><code>dist.method</code> "euclidean", as it is the distance that has been used
for clustering the gene set trends.</p></li>
<li><p><code>legend.breaks</code> a numeric vector giving the splitting points used
for coloring the heatmap.  If <code>plot</code> is <code>FALSE</code>, then it is
<code>NULL</code>.</p></li>
<li><p><code>myclusters</code> a character vector of colors for clusters of the
represented gene sets, with as many levels as the value of <code>N_clusters</code>.
If no clusters were represented, than this is <code>NULL</code>.</p></li>
<li><p><code>ddr</code> a <b>dendrogram</b> object with the reordering used for the
heatmap.  See <code>heatmap.2</code> function from package 
<code>gplots</code>.</p></li>
<li><p><code>clustersExport</code> a data frame with 2 variables containing the two
following variables :</p><ul><li><p><code>GeneSet</code>: the gene sets
clustered.</p></li>
<li><p><code>Cluster</code>: the cluster they belong to.</p></li>
</ul><p>The data
frame is order by the variable <code>Cluster</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>On the heatmap, each line corresponds to a gene set, and each column to a
time point.</p>
<p>First a heatmap is computed on all the patients (see <code><a href="plot.TcGSA.html">plot.TcGSA</a></code>
and <code><a href="clustTrend.html">clustTrend</a></code>) to define the clustering. Then, the clustering
and coloring thus defined on all the patients are consistently used in the
separate heatmaps that are plotted by patient.</p>
<p>If <code>expr</code> is a matrix or a dataframe, then the "original" data are
plotted.  On the other hand, if <code>expr</code> is a list returned in the
<code>'Estimations'</code> element of <code><a href="TcGSA.LR.html">TcGSA.LR</a></code>, then it is those
"estimations" made by the <code><a href="TcGSA.LR.html">TcGSA.LR</a></code> function that are plotted.</p>
<p>If <code>descript</code> is <code>FALSE</code>, the second element of <code>margins</code> can
be reduced (for instance use <code>margins = c(5, 10)</code>), as there is not so
much need for space in order to display only the gene set names, without
their description.</p>
<p>The median shown in the heatmap uses the respectively standardized (reduced
and centered) expression of the genes over the patients.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hejblum BP, Skinner J, Thiebaut R, (2015) 
Time-Course Gene Set Analysis for Longitudinal Gene Expression Data. 
<em>PLOS Comput. Biol.</em> 11(6):e1004310.
doi: 10.1371/journal.pcbi.1004310</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot.TcGSA.html">plot.TcGSA</a></code>,
<code><a href="TcGSA.LR.html">TcGSA.LR</a></code>, <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Boris P. Hejblum</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data_simu_TcGSA</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">tcgsa_sim_1grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="TcGSA.LR.html">TcGSA.LR</a></span><span class="op">(</span>expr<span class="op">=</span><span class="va">expr_1grp</span>, gmt<span class="op">=</span><span class="va">gmt_sim</span>, design<span class="op">=</span><span class="va">design</span>, </span>
<span class="r-in">                          subject_name<span class="op">=</span><span class="st">"Patient_ID"</span>, time_name<span class="op">=</span><span class="st">"TimePoint"</span>,</span>
<span class="r-in">                          time_func<span class="op">=</span><span class="st">"linear"</span>, crossedRandom<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">plotPat.TcGSA</span><span class="op">(</span>x<span class="op">=</span><span class="va">tcgsa_sim_1grp</span>, expr<span class="op">=</span><span class="va">expr_1grp</span>, </span>
<span class="r-in">    Subject_ID<span class="op">=</span><span class="va">design</span><span class="op">$</span><span class="va">Patient_ID</span>, TimePoint<span class="op">=</span><span class="va">design</span><span class="op">$</span><span class="va">TimePoint</span>,</span>
<span class="r-in">    B<span class="op">=</span><span class="fl">100</span>,</span>
<span class="r-in">    time_unit<span class="op">=</span><span class="st">"H"</span></span>
<span class="r-in">    <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">plotPat.TcGSA</span><span class="op">(</span>x<span class="op">=</span><span class="va">tcgsa_sim_1grp</span>, expr<span class="op">=</span><span class="va">tcgsa_sim_1grp</span><span class="op">$</span><span class="va">Estimations</span>, </span>
<span class="r-in">    Subject_ID<span class="op">=</span><span class="va">design</span><span class="op">$</span><span class="va">Patient_ID</span>, TimePoint<span class="op">=</span><span class="va">design</span><span class="op">$</span><span class="va">TimePoint</span>,</span>
<span class="r-in">    baseline<span class="op">=</span><span class="fl">1</span>, </span>
<span class="r-in">    B<span class="op">=</span><span class="fl">100</span>,</span>
<span class="r-in">    time_unit<span class="op">=</span><span class="st">"H"</span></span>
<span class="r-in">    <span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://borishejblum.science" class="external-link">Boris P Hejblum</a>, Damien Chimits, Anthony Devaux.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

